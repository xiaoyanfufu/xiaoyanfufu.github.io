<!DOCTYPE html><html lang="zn-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>计算机网络-应用层(下) | XIAOYAN</title><meta name="keywords" content="JWT,WebSoket,Nginx"><meta name="author" content="xiaoyan"><meta name="copyright" content="xiaoyan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="计算机网络-应用层(下)"><meta name="application-name" content="计算机网络-应用层(下)"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="计算机网络-应用层(下)"><meta property="og:url" content="http://example.com/2024/10/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%BA%94%E7%94%A8%E5%B1%82(%E4%B8%8B)/index.html"><meta property="og:site_name" content="XIAOYAN"><meta property="og:description" content="JWT 令牌JWT 令牌和传统方式有什么区别JWT（JSON Web Token）是一种基于令牌的身份验证机制，与传统的会话管理方式（如Cookie和Session）在多个方面存在显著差异。以下是对JWT令牌与传统方式的详细比较： 1.无状态性  JWT：JWT是无状态的令牌，服务器不需要在服务器端"><meta property="og:locale" content="zn-CN"><meta property="og:image" content="https://cdn.auth0.com/website/jwt/introduction/client-credentials-grant.png"><meta property="article:author" content="xiaoyan"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.auth0.com/website/jwt/introduction/client-credentials-grant.png"><meta name="description" content="JWT 令牌JWT 令牌和传统方式有什么区别JWT（JSON Web Token）是一种基于令牌的身份验证机制，与传统的会话管理方式（如Cookie和Session）在多个方面存在显著差异。以下是对JWT令牌与传统方式的详细比较： 1.无状态性  JWT：JWT是无状态的令牌，服务器不需要在服务器端"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="canonical" href="http://example.com/2024/10/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%BA%94%E7%94%A8%E5%B1%82(%E4%B8%8B)/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: undefined,
  diytitle: undefined,
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: xiaoyan","link":"链接: ","source":"来源: XIAOYAN","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'XIAOYAN',
  title: '计算机网络-应用层(下)',
  postAI: '',
  pageFillDescription: 'JWT 令牌, JWT 令牌和传统方式有什么区别, JWT 令牌详解, JWT的结构, 1. 头部（Header）, 2. 载荷（Payload）, 3. 签名（Signature）, JWT的工作流程, JWT的优点, JWT的缺点, JWT 如何解决集群部署问题, JWT 缺点, JWT的缺点, 解决方案, JWT 前端存储方案, WebSocket, 了解WebSocket, WebSocket工作过程, HTTP长连接与WebSocket的区别, HTTP长连接, 适用场景, 性能特点, WebSocket, 适用场景, 性能特点, 区别总结, Nginx, Nginx负载均衡算法令牌令牌和传统方式有什么区别是一种基于令牌的身份验证机制与传统的会话管理方式如和在多个方面存在显著差异以下是对令牌与传统方式的详细比较无状态性是无状态的令牌服务器不需要在服务器端存储会话信息令牌本身包含了所有必要的信息如用户身份权限等服务器在用户首次登录时获取用户信息并加密生成令牌返回给客户端客户端在后续请求中携带令牌服务器通过验证令牌来确认用户身份传统方式如传统方式通常需要在服务器端存储会话信息服务器为每个用户生成一个唯一的并将其通过或其他方式传递给客户端客户端在后续请求中携带服务器根据查找对应的用户状态信息这种方式需要在服务器端维护会话状态增加了服务器的负担安全性使用密钥对令牌进行签名确保令牌的完整性和真实性即使令牌在传输过程中被截获攻击者也无法篡改令牌内容而不被发现还可以使用加密算法对令牌进行加密进一步提高安全性传统方式如传统方式的安全性依赖于服务器端存储的会话信息虽然数据存储在服务器端不易受到客户端攻击但仍然可能存在劫持的风险特别是在通过不安全的通道如未加密的传输时跨域支持可以在不同域之间传递适用于跨域访问的场景通过在请求头或参数中携带令牌可以实现无需的跨域身份验证的无状态性和自包含特性使其非常适合在分布式系统和微服务架构中使用传统方式如传统方式如在跨域访问时存在一定的限制通常只能在同一域名下使用跨域访问需要特殊处理如配置此外还容易受到跨站请求伪造攻击需要采取额外的安全措施可扩展性的可扩展性非常好因为是无状态的服务器不需要存储信息可以轻松地在分布式系统中使用适用于大规模和高并发的应用场景传统方式如传统方式的可扩展性较差因为需要在服务器端存储和管理会话信息随着用户数量的增加服务器需要维护大量的会话数据可能会增加服务器的负担适用场景适用于需要无状态身份验证的场景如单点登录访问控制微服务架构等的无状态性和自包含特性使其非常适合在分布式系统和微服务架构中使用传统方式如适用于需要服务器端存储大量数据的场景如用户登录状态购物车信息等传统方式在需要维护复杂会话状态的应用中仍然有其优势令牌详解是一种基于令牌的身份验证机制广泛应用于现代应用和中令牌是一种紧凑且自包含的方式用于在客户端和服务器之间安全地传输信息以下是对令牌的详细解析的结构令牌由三部分组成分别是头部载荷和签名这三部分通过分隔头部头部通常包含两部分信息令牌类型和使用的签名算法例如指定使用的签名算法如等指定令牌类型通常为载荷载荷包含实际需要传输的数据通常包括用户身份信息权限信息等载荷可以包含自定义的声明也可以包含一些标准声明例如主题通常是用户的唯一标识用户名签发时间表示令牌的创建时间其他常见的标准声明包括签发者过期时间生效时间唯一标识符签名签名用于验证令牌的完整性和真实性签名是通过将头部和载荷进行编码后使用指定的算法和密钥生成的例如使用算法生成签名的过程如下的工作流程用户登录用户在客户端输入用户名和密码进行登录客户端将登录请求发送到服务器服务器验证服务器验证用户的身份如果验证成功服务器生成令牌生成服务器将用户信息如用户权限等放入的载荷中使用密钥对头部和载荷进行签名生成令牌返回服务器将生成的令牌返回给客户端客户端存储客户端将令牌存储在本地如浏览器存储本地存储或移动设备后续请求客户端在后续请求中携带令牌通常通过请求头或参数传递服务器验证服务器接收到请求后验证令牌的签名和有效性如果验证通过服务器处理请求否则拒绝请求的优点无状态性是无状态的服务器不需要存储信息适用于分布式系统和微服务架构安全性使用签名和加密算法确保令牌的完整性和真实性防止篡改和伪造跨域支持可以在不同域之间传递适用于跨域访问的场景可扩展性的可扩展性非常好适用于大规模和高并发的应用场景的缺点令牌大小令牌的大小可能会比较大特别是当载荷中包含大量信息时无法撤销令牌一旦签发除非过期否则无法撤销如果需要撤销令牌通常需要额外的机制如黑名单安全性依赖密钥的安全性依赖于密钥的安全性如果密钥泄露攻击者可以伪造令牌如何解决集群部署问题传统的请求方式基于和会话机制数据信息保存在服务器或数据库中而在集群部署情况下每台服务器的数据是独立的如要实现共享需要额外的共享操作这就会消耗额外的性能和空间而不同于传统方式令牌是无状态的会话所需要的数据被加密到令牌当中这样能够样用户即使切换到新的服务器也不需要再重新登陆服务器只需要对令牌进行校验解析即可获取到用户的信息由于令牌是自包含的服务器可以独立地对令牌进行校验而不需要依赖于其他服务器或共享存储使得集群中的每个服务器都能独立地处理请求增加集群系统的可伸缩性和容错性缺点的缺点无法撤销令牌令牌一旦签发除非过期否则无法撤销这意味着如果令牌被泄露或需要强制注销用户服务器无法直接撤销令牌只能等待令牌自然过期令牌大小令牌的大小可能会比较大特别是当载荷中包含大量信息时这可能会增加网络传输的开销特别是在移动设备或低带宽环境下安全性依赖密钥的安全性依赖于密钥的安全性如果密钥泄露攻击者可以伪造令牌因此密钥的管理和保护至关重要解决方案黑名单策略为了解决令牌无法撤销的问题可以采用黑名单策略具体步骤如下维护黑名单服务器维护一个黑名单数据结构如内存数据库用于存储已撤销的令牌拦截过滤在处理请求时服务器首先检查令牌是否在黑名单中如果在黑名单中服务器拒绝请求否则继续验证令牌的有效性定期清理定期清理黑名单中的过期令牌避免黑名单数据无限增长设置合理的过期时间为了减少令牌泄露的风险可以设置合理的令牌过期时间较短的过期时间可以降低令牌被滥用的风险但也会增加用户频繁登录的频率使用刷新令牌机制为了平衡安全性和用户体验可以使用刷新令牌机制具体步骤如下签发访问令牌和刷新令牌在用户登录成功后服务器签发一个短期有效的访问令牌和一个长期有效的刷新令牌使用访问令牌客户端在后续请求中使用访问令牌进行身份验证如果访问令牌过期客户端可以使用刷新令牌向服务器请求新的访问令牌撤销刷新令牌如果需要强制注销用户服务器可以撤销刷新令牌从而阻止用户获取新的访问令牌使用加密传输为了防止令牌在传输过程中被截获建议使用加密传输令牌可以确保令牌在传输过程中的安全性防止中间人攻击密钥管理为了提高的安全性需要采取以下密钥管理措施使用强加密算法使用强加密算法如生成确保令牌的不可伪造性密钥轮换定期轮换密钥避免密钥长时间使用带来的安全风险密钥保护确保密钥的安全存储避免密钥泄露前端存储方案是目前最流行的跨域认证解决方案之一客户端收到服务器返回的令牌后通常需要将其存储在客户端本地常见的存储方案包括和以下是对这三种存储方案的详细解析较大的存储空间提供了较大的存储空间通常为可以存储较长的令牌不会随请求发送中的数据不会自动随请求发送到服务器减少了网络传输的开销风险容易受到跨站脚本攻击攻击者可以通过注入恶意代码读取存储在中的令牌从而盗取用户身份凭证较大的存储空间同样提供了较大的存储空间通常为可以存储较长的令牌仅限于当前浏览器窗口中的数据仅限于当前浏览器窗口关闭窗口后数据会被清除适合短期存储用户体验问题中的数据在刷新网页或关闭窗口后会被清除导致用户需要重新验证身份影响用户体验风险同样容易受到攻击攻击者可以通过注入恶意代码读取存储在中的令牌自动发送中的数据会自动随请求发送到服务器服务器可以方便地验证令牌安全性增强可以通过设置和属性来提高的安全性属性可以防止访问减少攻击的风险属性可以确保只在连接中传输防止中间人攻击存储空间限制单个的大小通常限制在左右并且大多数浏览器对单个域名下的数量也有一定的限制通常为个左右跨域问题在跨域访问时存在一定的限制需要特殊处理如配置了解工作过程长连接与的区别长连接和是两种不同的网络通信技术它们在实现机制适用场景和性能特点上存在显著差异以下是对这两种技术的详细比较长连接长连接也称为持久连接或连接是基于协议的一种连接复用技术在中默认情况下连接是持久的即客户端和服务器之间的连接在完成一次请求后不会立即关闭而是保持打开状态以便后续请求可以复用该连接适用场景静态资源请求适用于频繁请求静态资源的场景如网页中的图片文件等短时间内的多次请求适用于客户端在短时间内需要多次请求服务器资源的场景性能特点减少连接建立开销通过复用连接减少了每次请求的连接建立和关闭的开销提高了网络传输效率减少延迟减少了每次请求的往返时间降低了网络延迟适用范围有限长连接主要适用于短时间内的多次请求对于需要长时间保持连接的场景如实时通信长连接并不适用是一种全双工通信协议允许客户端和服务器之间进行双向实时通信协议本身是全双工的但我们常用的虽然基于协议却是半双工的因为是应答模式协议在协议的基础上进行升级通过一次握手过程建立持久连接之后双方可以通过该连接进行实时数据传输适用场景实时通信适用于需要实时通信的场景如在线聊天实时游戏股票行情等实时数据推送适用于服务器需要主动向客户端推送数据的场景如实时通知实时监控等性能特点全双工通信支持全双工通信客户端和服务器可以同时发送和接收数据实现实时双向通信低延迟连接建立后数据传输的延迟较低适合实时通信场景轻量级协议协议本身较为轻量数据传输的开销较小适合高频数据传输区别总结特性长连接实现机制基于协议的连接复用技术基于协议升级的全双工通信协议适用场景静态资源请求短时间内的多次请求实时通信实时数据推送通信方式半双工请求响应模式全双工双向实时通信连接保持连接保持时间有限适用于短时间请求持久连接适用于长时间实时通信协议开销每次请求需要携带头信息协议开销较小适合高频数据传输数据传输延迟每次请求的往返时间较高数据传输延迟较低适合实时通信负载均衡算法轮询按照请求顺序依次分配给后端请求这种算法最简单但无法应对单点缓慢以及用户连续请求情况哈希根据客户端地址来计算哈希值分配到对应的后端服务器能够保证客户端总能请求到同一台服务器哈希按访问的哈希结果来分配后端服务器可以进一步增加后端服务器缓存的使用率最短响应时间根据后端服务器的响应时间来进行分配响应速度越快的服务器会收到的请求越多能够充分利用后端服务器的性能实现负载均衡加权轮询按照权重分配请求给后端服务器权重越高的服务器会收到更多的请求适用于后端服务器性能不同的情况提高高性能服务器利用率实现负载均衡',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-04 11:40:02',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/images/star.png"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">XIAOYAN</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=12613265870&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AOP/" style="font-size: 1.05rem;">AOP<sup>1</sup></a><a href="/tags/Bean/" style="font-size: 1.05rem;">Bean<sup>1</sup></a><a href="/tags/DDD/" style="font-size: 1.05rem;">DDD<sup>1</sup></a><a href="/tags/IoC/" style="font-size: 1.05rem;">IoC<sup>1</sup></a><a href="/tags/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" style="font-size: 1.05rem;">Java8新特性<sup>1</sup></a><a href="/tags/Java%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" style="font-size: 1.05rem;">Java基本概念<sup>1</sup></a><a href="/tags/List/" style="font-size: 1.05rem;">List<sup>1</sup></a><a href="/tags/Map/" style="font-size: 1.05rem;">Map<sup>2</sup></a><a href="/tags/MyBatis/" style="font-size: 1.05rem;">MyBatis<sup>1</sup></a><a href="/tags/MySQL%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">MySQL基础<sup>1</sup></a><a href="/tags/Object/" style="font-size: 1.05rem;">Object<sup>1</sup></a><a href="/tags/SQL%E8%B0%83%E4%BC%98/" style="font-size: 1.05rem;">SQL调优<sup>1</sup></a><a href="/tags/Set/" style="font-size: 1.05rem;">Set<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 1.05rem;">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 1.05rem;">SpringCloud<sup>1</sup></a><a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 1.05rem;">事务<sup>2</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/" style="font-size: 1.05rem;">内存模型<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 1.05rem;">反射<sup>1</sup></a><a href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" style="font-size: 1.05rem;">垃圾回收<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 1.05rem;">多线程<sup>1</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">对象<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">并发安全<sup>1</sup></a><a href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 1.05rem;">序列化<sup>1</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8/" style="font-size: 1.05rem;">异常<sup>1</sup></a><a href="/tags/%E6%8B%B7%E8%B4%9D/" style="font-size: 1.05rem;">拷贝<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 1.05rem;">数据类型<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.05rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 1.05rem;">日志<sup>2</sup></a><a href="/tags/%E6%9F%A5%E8%AF%A2/" style="font-size: 1.05rem;">查询<sup>1</sup></a><a href="/tags/%E6%B3%9B%E5%9E%8B/" style="font-size: 1.05rem;">泛型<sup>1</sup></a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 1.05rem;">注解<sup>1</sup></a><a href="/tags/%E7%AD%96%E7%95%A5/" style="font-size: 1.05rem;">策略<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96/" style="font-size: 1.05rem;">类初始化<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" style="font-size: 1.05rem;">类加载<sup>1</sup></a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 1.05rem;">索引<sup>2</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/" style="font-size: 1.05rem;">线程模型<sup>1</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/" style="font-size: 1.05rem;">线程池<sup>1</sup></a><a href="/tags/%E9%94%81/" style="font-size: 1.05rem;">锁<sup>2</sup></a><a href="/tags/%E9%9B%86%E7%BE%A4/" style="font-size: 1.05rem;">集群<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">November 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">October 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">25</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">July 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" itemprop="url">计算机基础</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url">计算机网络</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/JWT/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>JWT</span></a><a class="article-meta__tags" href="/tags/WebSoket/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>WebSoket</span></a><a class="article-meta__tags" href="/tags/Nginx/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Nginx</span></a></span></div></div><h1 class="post-title" itemprop="name headline">计算机网络-应用层(下)</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-10-13T04:18:49.000Z" title="发表于 2024-10-13 12:18:49">2024-10-13</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-11-04T03:40:02.460Z" title="更新于 2024-11-04 11:40:02">2024-11-04</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为桂林"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>桂林</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://cdn.auth0.com/website/jwt/introduction/client-credentials-grant.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/10/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%BA%94%E7%94%A8%E5%B1%82(%E4%B8%8B)/"><header><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/" itemprop="url">计算机基础</a><a class="post-meta-categories" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" itemprop="url">计算机网络</a><a href="/tags/JWT/" tabindex="-1" itemprop="url">JWT</a><a href="/tags/WebSoket/" tabindex="-1" itemprop="url">WebSoket</a><a href="/tags/Nginx/" tabindex="-1" itemprop="url">Nginx</a><h1 id="CrawlerTitle" itemprop="name headline">计算机网络-应用层(下)</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">xiaoyan</span><time itemprop="dateCreated datePublished" datetime="2024-10-13T04:18:49.000Z" title="发表于 2024-10-13 12:18:49">2024-10-13</time><time itemprop="dateCreated datePublished" datetime="2024-11-04T03:40:02.460Z" title="更新于 2024-11-04 11:40:02">2024-11-04</time></header><h1 id="JWT-令牌"><a href="#JWT-令牌" class="headerlink" title="JWT 令牌"></a>JWT 令牌</h1><h2 id="JWT-令牌和传统方式有什么区别"><a href="#JWT-令牌和传统方式有什么区别" class="headerlink" title="JWT 令牌和传统方式有什么区别"></a>JWT 令牌和传统方式有什么区别</h2><p>JWT（JSON Web Token）是一种基于令牌的身份验证机制，与传统的会话管理方式（如Cookie和Session）在多个方面存在显著差异。以下是对JWT令牌与传统方式的详细比较：</p>
<p>1.无状态性</p>
<ul>
<li><strong>JWT</strong>：JWT是无状态的令牌，服务器不需要在服务器端存储会话信息。JWT令牌本身包含了所有必要的信息，如用户身份、权限等。服务器在用户首次登录时获取用户信息并加密生成JWT令牌，返回给客户端。客户端在后续请求中携带JWT令牌，服务器通过验证令牌来确认用户身份。</li>
<li><strong>传统方式（如Session）</strong>：传统方式通常需要在服务器端存储会话信息。服务器为每个用户生成一个唯一的Session ID，并将其通过Cookie或其他方式传递给客户端。客户端在后续请求中携带Session ID，服务器根据Session ID查找对应的用户状态信息。这种方式需要在服务器端维护会话状态，增加了服务器的负担。</li>
</ul>
<p>2.安全性</p>
<ul>
<li><strong>JWT</strong>：JWT使用密钥对令牌进行签名，确保令牌的完整性和真实性。即使令牌在传输过程中被截获，攻击者也无法篡改令牌内容而不被发现。JWT还可以使用加密算法对令牌进行加密，进一步提高安全性。</li>
<li><strong>传统方式（如Session）</strong>：传统方式的安全性依赖于服务器端存储的会话信息。虽然Session数据存储在服务器端，不易受到客户端攻击，但仍然可能存在Session劫持的风险，特别是在Session ID通过不安全的通道（如未加密的HTTP）传输时。</li>
</ul>
<p>3.跨域支持</p>
<ul>
<li><strong>JWT</strong>：JWT可以在不同域之间传递，适用于跨域访问的场景。通过在请求头或参数中携带JWT令牌，可以实现无需Cookie的跨域身份验证。JWT的无状态性和自包含特性使其非常适合在分布式系统和微服务架构中使用。</li>
<li><strong>传统方式（如Cookie）</strong>：<br>传统方式（如Cookie）在跨域访问时存在一定的限制。Cookie通常只能在同一域名下使用，跨域访问需要特殊处理（如CORS配置）。此外，Cookie还容易受到跨站请求伪造（CSRF）攻击，需要采取额外的安全措施。</li>
</ul>
<p>4。可扩展性</p>
<ul>
<li><strong>JWT</strong>：JWT的可扩展性非常好，因为JWT是无状态的，服务器不需要存储JWT信息。JWT可以轻松地在分布式系统中使用，适用于大规模和高并发的应用场景。</li>
<li><strong>传统方式（如Session）</strong>：传统方式的可扩展性较差，因为需要在服务器端存储和管理会话信息。随着用户数量的增加，服务器需要维护大量的会话数据，可能会增加服务器的负担。</li>
</ul>
<p>5.适用场景</p>
<ul>
<li><strong>JWT</strong>：适用于需要无状态身份验证的场景，如单点登录（SSO）、API访问控制、微服务架构等。JWT的无状态性和自包含特性使其非常适合在分布式系统和微服务架构中使用。</li>
<li><strong>传统方式（如Session）</strong>：适用于需要服务器端存储大量数据的场景，如用户登录状态、购物车信息等。传统方式在需要维护复杂会话状态的应用中仍然有其优势。</li>
</ul>
<h2 id="JWT-令牌详解"><a href="#JWT-令牌详解" class="headerlink" title="JWT 令牌详解"></a>JWT 令牌详解</h2><p>JWT（JSON Web Token）是一种基于令牌的身份验证机制，广泛应用于现代Web应用和API中。JWT令牌是一种紧凑且自包含的方式，用于在客户端和服务器之间安全地传输信息。以下是对JWT令牌的详细解析：</p>
<h3 id="JWT的结构"><a href="#JWT的结构" class="headerlink" title="JWT的结构"></a>JWT的结构</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.xiaolincoding.com//picgo/image-20240725231451188.png" alt="JWT结构"></p>
<p>JWT令牌由三部分组成，分别是头部（Header）、载荷（Payload）和签名（Signature），这三部分通过<code>.</code>分隔。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiIxMjM0NTY3ODkwIiwibmFtZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMeJf36POk6yJV_adQssw5c</span><br></pre></td></tr></table></figure>

<h4 id="1-头部（Header）"><a href="#1-头部（Header）" class="headerlink" title="1. 头部（Header）"></a>1. 头部（Header）</h4><p>头部通常包含两部分信息：令牌类型（typ）和使用的签名算法（alg）。例如：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;alg&quot;</span><span class="punctuation">:</span> <span class="string">&quot;HS256&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;typ&quot;</span><span class="punctuation">:</span> <span class="string">&quot;JWT&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>alg</code>：指定使用的签名算法，如HMAC SHA256（HS256）、RSA SHA256（RS256）等。</li>
<li><code>typ</code>：指定令牌类型，通常为<code>JWT</code>。</li>
</ul>
<h4 id="2-载荷（Payload）"><a href="#2-载荷（Payload）" class="headerlink" title="2. 载荷（Payload）"></a>2. 载荷（Payload）</h4><p>载荷包含实际需要传输的数据，通常包括用户身份信息、权限信息等。载荷可以包含自定义的声明（Claims），也可以包含一些标准声明（Registered Claims）。例如：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;sub&quot;</span><span class="punctuation">:</span> <span class="string">&quot;1234567890&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;John Doe&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;iat&quot;</span><span class="punctuation">:</span> <span class="number">1516239022</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li><code>sub</code>：主题（Subject），通常是用户的唯一标识。</li>
<li><code>name</code>：用户名。</li>
<li><code>iat</code>：签发时间（Issued At），表示令牌的创建时间。</li>
</ul>
<p>其他常见的标准声明包括：</p>
<ul>
<li><code>iss</code>：签发者（Issuer）。</li>
<li><code>exp</code>：过期时间（Expiration Time）。</li>
<li><code>nbf</code>：生效时间（Not Before）。</li>
<li><code>jti</code>：JWT ID，唯一标识符。</li>
</ul>
<h4 id="3-签名（Signature）"><a href="#3-签名（Signature）" class="headerlink" title="3. 签名（Signature）"></a>3. 签名（Signature）</h4><p>签名用于验证令牌的完整性和真实性。签名是通过将头部和载荷进行Base64编码后，使用指定的算法和密钥生成的。例如，使用HMAC SHA256算法生成签名的过程如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(</span><br><span class="line">  base64UrlEncode(header) + &quot;.&quot; +</span><br><span class="line">  base64UrlEncode(payload),</span><br><span class="line">  secret</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h3 id="JWT的工作流程"><a href="#JWT的工作流程" class="headerlink" title="JWT的工作流程"></a>JWT的工作流程</h3><ol>
<li><p><strong>用户登录</strong>：用户在客户端输入用户名和密码进行登录，客户端将登录请求发送到服务器。</p>
</li>
<li><p><strong>服务器验证</strong>：服务器验证用户的身份，如果验证成功，服务器生成JWT令牌。</p>
</li>
<li><p><strong>生成JWT</strong>：服务器将用户信息（如用户ID、权限等）放入JWT的载荷中，使用密钥对头部和载荷进行签名，生成JWT令牌。</p>
</li>
<li><p><strong>返回JWT</strong>：服务器将生成的JWT令牌返回给客户端。</p>
</li>
<li><p><strong>客户端存储JWT</strong>：客户端将JWT令牌存储在本地（如浏览器存储、本地存储或移动设备）。</p>
</li>
<li><p><strong>后续请求</strong>：客户端在后续请求中携带JWT令牌，通常通过HTTP请求头（Authorization: Bearer <token>）或URL参数传递。</token></p>
</li>
<li><p><strong>服务器验证JWT</strong>：服务器接收到请求后，验证JWT令牌的签名和有效性。如果验证通过，服务器处理请求；否则，拒绝请求。</p>
</li>
</ol>
<h3 id="JWT的优点"><a href="#JWT的优点" class="headerlink" title="JWT的优点"></a>JWT的优点</h3><ul>
<li><strong>无状态性</strong>：JWT是无状态的，服务器不需要存储JWT信息，适用于分布式系统和微服务架构。</li>
<li><strong>安全性</strong>：JWT使用签名和加密算法确保令牌的完整性和真实性，防止篡改和伪造。</li>
<li><strong>跨域支持</strong>：JWT可以在不同域之间传递，适用于跨域访问的场景。</li>
<li><strong>可扩展性</strong>：JWT的可扩展性非常好，适用于大规模和高并发的应用场景。</li>
</ul>
<h3 id="JWT的缺点"><a href="#JWT的缺点" class="headerlink" title="JWT的缺点"></a>JWT的缺点</h3><ul>
<li><strong>令牌大小</strong>：JWT令牌的大小可能会比较大，特别是当载荷中包含大量信息时。</li>
<li><strong>无法撤销</strong>：JWT令牌一旦签发，除非过期，否则无法撤销。如果需要撤销令牌，通常需要额外的机制（如黑名单）。</li>
<li><strong>安全性依赖密钥</strong>：JWT的安全性依赖于密钥的安全性，如果密钥泄露，攻击者可以伪造JWT令牌。</li>
</ul>
<h2 id="JWT-如何解决集群部署问题"><a href="#JWT-如何解决集群部署问题" class="headerlink" title="JWT 如何解决集群部署问题"></a>JWT 如何解决集群部署问题</h2><p>传统的请求方式基于Cookie和会话机制，数据信息保存在服务器或数据库中，而在集群部署情况下，每台服务器的数据是独立的，如要实现共享需要额外的共享操作，这就会消耗额外的性能和空间。</p>
<p>而不同于传统方式，JWT令牌是无状态的，会话所需要的数据被加密到令牌当中，这样能够样用户即使切换到新的服务器也不需要再重新登陆，服务器只需要对令牌进行校验解析即可获取到用户的信息。</p>
<p>由于JWT令牌是自包含的，服务器可以独立地对令牌进行校验，而不需要依赖于其他服务器或共享存储，使得集群中的每个服务器都能独立地处理请求，增加集群系统的可伸缩性和容错性。</p>
<h2 id="JWT-缺点"><a href="#JWT-缺点" class="headerlink" title="JWT 缺点"></a>JWT 缺点</h2><h3 id="JWT的缺点-1"><a href="#JWT的缺点-1" class="headerlink" title="JWT的缺点"></a>JWT的缺点</h3><ol>
<li><p>无法撤销令牌：JWT令牌一旦签发，除非过期，否则无法撤销。这意味着如果令牌被泄露或需要强制注销用户，服务器无法直接撤销令牌，只能等待令牌自然过期。</p>
</li>
<li><p>令牌大小：JWT令牌的大小可能会比较大，特别是当载荷中包含大量信息时。这可能会增加网络传输的开销，特别是在移动设备或低带宽环境下。</p>
</li>
<li><p>安全性依赖密钥：JWT的安全性依赖于密钥的安全性，如果密钥泄露，攻击者可以伪造JWT令牌。因此，密钥的管理和保护至关重要。</p>
</li>
</ol>
<h3 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h3><ol>
<li>黑名单策略</li>
</ol>
<p>为了解决JWT令牌无法撤销的问题，可以采用黑名单策略。具体步骤如下：</p>
<ul>
<li><strong>维护黑名单</strong>：服务器维护一个黑名单数据结构（如Redis、内存数据库），用于存储已撤销的JWT令牌。</li>
<li><strong>拦截过滤</strong>：在处理请求时，服务器首先检查JWT令牌是否在黑名单中。如果在黑名单中，服务器拒绝请求；否则，继续验证令牌的有效性。</li>
<li><strong>定期清理</strong>：定期清理黑名单中的过期令牌，避免黑名单数据无限增长。</li>
</ul>
<ol start="2">
<li>设置合理的过期时间</li>
</ol>
<p>为了减少令牌泄露的风险，可以设置合理的JWT令牌过期时间。较短的过期时间可以降低令牌被滥用的风险，但也会增加用户频繁登录的频率。</p>
<ol start="3">
<li>使用刷新令牌机制</li>
</ol>
<p>为了平衡安全性和用户体验，可以使用刷新令牌（Refresh Token）机制。具体步骤如下：</p>
<ul>
<li><strong>签发访问令牌和刷新令牌</strong>：在用户登录成功后，服务器签发一个短期有效的访问令牌（Access Token）和一个长期有效的刷新令牌（Refresh Token）。</li>
<li><strong>使用访问令牌</strong>：客户端在后续请求中使用访问令牌进行身份验证。如果访问令牌过期，客户端可以使用刷新令牌向服务器请求新的访问令牌。</li>
<li><strong>撤销刷新令牌</strong>：如果需要强制注销用户，服务器可以撤销刷新令牌，从而阻止用户获取新的访问令牌。</li>
</ul>
<ol start="4">
<li>使用HTTPS加密传输</li>
</ol>
<p>为了防止令牌在传输过程中被截获，建议使用HTTPS加密传输JWT令牌。HTTPS可以确保令牌在传输过程中的安全性，防止中间人攻击。</p>
<ol start="5">
<li>密钥管理</li>
</ol>
<p>为了提高JWT的安全性，需要采取以下密钥管理措施：</p>
<ul>
<li><strong>使用强加密算法</strong>：使用强加密算法（如HS256、RS256）生成JWT，确保令牌的不可伪造性。</li>
<li><strong>密钥轮换</strong>：定期轮换密钥，避免密钥长时间使用带来的安全风险。</li>
<li><strong>密钥保护</strong>：确保密钥的安全存储，避免密钥泄露。</li>
</ul>
<h2 id="JWT-前端存储方案"><a href="#JWT-前端存储方案" class="headerlink" title="JWT 前端存储方案"></a>JWT 前端存储方案</h2><p>JWT（JSON Web Token）是目前最流行的跨域认证解决方案之一。客户端收到服务器返回的JWT令牌后，通常需要将其存储在客户端本地。常见的存储方案包括Local Storage、Session Storage和Cookie。以下是对这三种存储方案的详细解析：</p>
<ol>
<li>Local Storage</li>
</ol>
<ul>
<li><p><strong>较大的存储空间</strong>：Local Storage提供了较大的存储空间（通常为5MB），可以存储较长的JWT令牌。</p>
</li>
<li><p><strong>不会随HTTP请求发送</strong>：Local Storage中的数据不会自动随HTTP请求发送到服务器，减少了网络传输的开销。</p>
</li>
<li><p><strong>XSS风险</strong>：Local Storage容易受到跨站脚本攻击（XSS）。攻击者可以通过注入恶意JavaScript代码读取存储在Local Storage中的JWT令牌，从而盗取用户身份凭证。</p>
</li>
</ul>
<ol start="2">
<li>Session Storage</li>
</ol>
<ul>
<li><p><strong>较大的存储空间</strong>：Session Storage同样提供了较大的存储空间（通常为5MB），可以存储较长的JWT令牌。</p>
</li>
<li><p><strong>仅限于当前浏览器窗口</strong>：Session Storage中的数据仅限于当前浏览器窗口，关闭窗口后数据会被清除，适合短期存储。</p>
</li>
<li><p><strong>用户体验问题</strong>：Session Storage中的数据在刷新网页或关闭窗口后会被清除，导致用户需要重新验证身份，影响用户体验。</p>
</li>
<li><p><strong>XSS风险</strong>：Session Storage同样容易受到XSS攻击，攻击者可以通过注入恶意JavaScript代码读取存储在Session Storage中的JWT令牌。</p>
</li>
</ul>
<ol start="3">
<li>Cookie</li>
</ol>
<ul>
<li><p><strong>自动发送</strong>：Cookie中的数据会自动随HTTP请求发送到服务器，服务器可以方便地验证JWT令牌。</p>
</li>
<li><p><strong>安全性增强</strong>：可以通过设置HTTPOnly和Secure属性来提高Cookie的安全性。HTTPOnly属性可以防止JavaScript访问Cookie，减少XSS攻击的风险；Secure属性可以确保Cookie只在HTTPS连接中传输，防止中间人攻击。</p>
</li>
<li><p><strong>存储空间限制</strong>：单个Cookie的大小通常限制在4KB左右，并且大多数浏览器对单个域名下的Cookie数量也有一定的限制（通常为20个左右）。</p>
</li>
<li><p><strong>跨域问题</strong>：Cookie在跨域访问时存在一定的限制，需要特殊处理（如CORS配置）。</p>
</li>
</ul>
<h1 id="WebSocket"><a href="#WebSocket" class="headerlink" title="WebSocket"></a>WebSocket</h1><h2 id="了解WebSocket"><a href="#了解WebSocket" class="headerlink" title="了解WebSocket"></a>了解WebSocket</h2><h3 id="WebSocket工作过程"><a href="#WebSocket工作过程" class="headerlink" title="WebSocket工作过程"></a>WebSocket工作过程</h3><h2 id="HTTP长连接与WebSocket的区别"><a href="#HTTP长连接与WebSocket的区别" class="headerlink" title="HTTP长连接与WebSocket的区别"></a>HTTP长连接与WebSocket的区别</h2><p>HTTP长连接和WebSocket是两种不同的网络通信技术，它们在实现机制、适用场景和性能特点上存在显著差异。以下是对这两种技术的详细比较：</p>
<h3 id="HTTP长连接"><a href="#HTTP长连接" class="headerlink" title="HTTP长连接"></a>HTTP长连接</h3><p>HTTP长连接（也称为持久连接或Keep-Alive连接）是基于HTTP协议的一种连接复用技术。在HTTP&#x2F;1.1中，默认情况下连接是持久的，即客户端和服务器之间的连接在完成一次请求后不会立即关闭，而是保持打开状态，以便后续请求可以复用该连接。</p>
<h4 id="适用场景"><a href="#适用场景" class="headerlink" title="适用场景"></a>适用场景</h4><ul>
<li><strong>静态资源请求</strong>：适用于频繁请求静态资源的场景，如网页中的图片、CSS、JavaScript文件等。</li>
<li><strong>短时间内的多次请求</strong>：适用于客户端在短时间内需要多次请求服务器资源的场景。</li>
</ul>
<h4 id="性能特点"><a href="#性能特点" class="headerlink" title="性能特点"></a>性能特点</h4><ul>
<li><strong>减少连接建立开销</strong>：通过复用连接，减少了每次请求的TCP连接建立和关闭的开销，提高了网络传输效率。</li>
<li><strong>减少延迟</strong>：减少了每次请求的往返时间（RTT），降低了网络延迟。</li>
<li><strong>适用范围有限</strong>：HTTP长连接主要适用于短时间内的多次请求，对于需要长时间保持连接的场景（如实时通信），HTTP长连接并不适用。</li>
</ul>
<h3 id="WebSocket-1"><a href="#WebSocket-1" class="headerlink" title="WebSocket"></a>WebSocket</h3><p>WebSocket是一种<strong>全双工</strong>通信协议，允许客户端和服务器之间进行双向实时通信（TCP协议本身是全双工的，但我们常用的HTTP&#x2F;1.1虽然基于TCP协议，却是<strong>半双工</strong>的，因为HTTP是应答模式）。WebSocket协议在HTTP协议的基础上进行升级，通过一次握手过程建立持久连接，之后双方可以通过该连接进行实时数据传输。</p>
<h4 id="适用场景-1"><a href="#适用场景-1" class="headerlink" title="适用场景"></a>适用场景</h4><ul>
<li><strong>实时通信</strong>：适用于需要实时通信的场景，如在线聊天、实时游戏、股票行情等。</li>
<li><strong>实时数据推送</strong>：适用于服务器需要主动向客户端推送数据的场景，如实时通知、实时监控等。</li>
</ul>
<h4 id="性能特点-1"><a href="#性能特点-1" class="headerlink" title="性能特点"></a>性能特点</h4><ul>
<li><strong>全双工通信</strong>：WebSocket支持全双工通信，客户端和服务器可以同时发送和接收数据，实现实时双向通信。</li>
<li><strong>低延迟</strong>：WebSocket连接建立后，数据传输的延迟较低，适合实时通信场景。</li>
<li><strong>轻量级协议</strong>：WebSocket协议本身较为轻量，数据传输的开销较小，适合高频数据传输。</li>
</ul>
<h3 id="区别总结"><a href="#区别总结" class="headerlink" title="区别总结"></a>区别总结</h3><table>
<thead>
<tr>
<th>特性</th>
<th>HTTP长连接</th>
<th>WebSocket</th>
</tr>
</thead>
<tbody><tr>
<td>实现机制</td>
<td>基于HTTP协议的连接复用技术</td>
<td>基于HTTP协议升级的全双工通信协议</td>
</tr>
<tr>
<td>适用场景</td>
<td>静态资源请求、短时间内的多次请求</td>
<td>实时通信、实时数据推送</td>
</tr>
<tr>
<td>通信方式</td>
<td>半双工（请求-响应模式）</td>
<td>全双工（双向实时通信）</td>
</tr>
<tr>
<td>连接保持</td>
<td>连接保持时间有限，适用于短时间请求</td>
<td>持久连接，适用于长时间实时通信</td>
</tr>
<tr>
<td>协议开销</td>
<td>每次请求需要携带HTTP头信息</td>
<td>协议开销较小，适合高频数据传输</td>
</tr>
<tr>
<td>数据传输延迟</td>
<td>每次请求的往返时间（RTT）较高</td>
<td>数据传输延迟较低，适合实时通信</td>
</tr>
</tbody></table>
<h1 id="Nginx"><a href="#Nginx" class="headerlink" title="Nginx"></a>Nginx</h1><h2 id="Nginx负载均衡算法"><a href="#Nginx负载均衡算法" class="headerlink" title="Nginx负载均衡算法"></a>Nginx负载均衡算法</h2><ul>
<li>轮询：按照请求顺序依次分配给后端请求。这种算法最简单，但无法应对单点缓慢以及用户连续请求情况。</li>
<li>IP哈希：根据客户端IP地址来计算哈希值，分配到对应的后端服务器，能够保证客户端总能请求到同一台服务器。</li>
<li>URL哈希：按访问的URL哈希结果来分配后端服务器，可以进一步增加后端服务器缓存的使用率。</li>
<li>最短响应时间：根据后端服务器的响应时间来进行分配，响应速度越快的服务器会收到的请求越多，能够充分利用后端服务器的性能，实现负载均衡。</li>
<li>加权轮询：按照权重分配请求给后端服务器，权重越高的服务器会收到更多的请求，适用于后端服务器性能不同的情况，提高高性能服务器利用率，实现负载均衡。</li>
</ul>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/user.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/user.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">xiaoyan</div><div class="post-copyright__author_desc">无限进步。</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/10/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%BA%94%E7%94%A8%E5%B1%82(%E4%B8%8B)/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/10/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%BA%94%E7%94%A8%E5%B1%82(%E4%B8%8B)/')">计算机网络-应用层(下)</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2024/10/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%BA%94%E7%94%A8%E5%B1%82(%E4%B8%8B)/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=计算机网络-应用层(下)&amp;url=http://example.com/2024/10/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%BA%94%E7%94%A8%E5%B1%82(%E4%B8%8B)/&amp;pic=https://cdn.auth0.com/website/jwt/introduction/client-credentials-grant.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">XIAOYAN</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>计算机基础<span class="categoryesPageCount">6</span></a><a class="post-meta__box__categoryes" href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E7%A1%80/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>计算机网络<span class="categoryesPageCount">5</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/JWT/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>JWT<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/WebSoket/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>WebSoket<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/Nginx/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Nginx<span class="tagsPageCount">1</span></a></div></div><div class="post_share"><div class="social-share" data-image="https://pic1.zhimg.com/v2-b76d79b11c3e8dd25f3c6abae8889a88_720w.jpg?source=172ae18b" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/10/12/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E5%BA%94%E7%94%A8%E5%B1%82(%E4%B8%8A)/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.xiaolincoding.com//picgo/1721710466863-78bf586d-a25c-4fe4-bf27-5dd576b998c8.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">计算机网络-应用层(上)</div></div></a></div><div class="next-post pull-right"><a href="/2024/10/13/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C-%E4%BC%A0%E8%BE%93%E5%B1%82/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.xiaolincoding.com//picgo/1719902940519-03556a12-819b-42b4-b6f7-41b4448d9d99.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">计算机网络-传输层</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/user.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">是一只时时翻垃圾吃的宅子。</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">xiaoyan</h1><div class="author-info__desc">无限进步。</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/xiaoyanfufu" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/483597064" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#JWT-%E4%BB%A4%E7%89%8C"><span class="toc-number">1.</span> <span class="toc-text">JWT 令牌</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#JWT-%E4%BB%A4%E7%89%8C%E5%92%8C%E4%BC%A0%E7%BB%9F%E6%96%B9%E5%BC%8F%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB"><span class="toc-number">1.1.</span> <span class="toc-text">JWT 令牌和传统方式有什么区别</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JWT-%E4%BB%A4%E7%89%8C%E8%AF%A6%E8%A7%A3"><span class="toc-number">1.2.</span> <span class="toc-text">JWT 令牌详解</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-number">1.2.1.</span> <span class="toc-text">JWT的结构</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%A4%B4%E9%83%A8%EF%BC%88Header%EF%BC%89"><span class="toc-number">1.2.1.1.</span> <span class="toc-text">1. 头部（Header）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E8%BD%BD%E8%8D%B7%EF%BC%88Payload%EF%BC%89"><span class="toc-number">1.2.1.2.</span> <span class="toc-text">2. 载荷（Payload）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E7%AD%BE%E5%90%8D%EF%BC%88Signature%EF%BC%89"><span class="toc-number">1.2.1.3.</span> <span class="toc-text">3. 签名（Signature）</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT%E7%9A%84%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%A8%8B"><span class="toc-number">1.2.2.</span> <span class="toc-text">JWT的工作流程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT%E7%9A%84%E4%BC%98%E7%82%B9"><span class="toc-number">1.2.3.</span> <span class="toc-text">JWT的优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT%E7%9A%84%E7%BC%BA%E7%82%B9"><span class="toc-number">1.2.4.</span> <span class="toc-text">JWT的缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JWT-%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E9%9B%86%E7%BE%A4%E9%83%A8%E7%BD%B2%E9%97%AE%E9%A2%98"><span class="toc-number">1.3.</span> <span class="toc-text">JWT 如何解决集群部署问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JWT-%E7%BC%BA%E7%82%B9"><span class="toc-number">1.4.</span> <span class="toc-text">JWT 缺点</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JWT%E7%9A%84%E7%BC%BA%E7%82%B9-1"><span class="toc-number">1.4.1.</span> <span class="toc-text">JWT的缺点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88"><span class="toc-number">1.4.2.</span> <span class="toc-text">解决方案</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#JWT-%E5%89%8D%E7%AB%AF%E5%AD%98%E5%82%A8%E6%96%B9%E6%A1%88"><span class="toc-number">1.5.</span> <span class="toc-text">JWT 前端存储方案</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#WebSocket"><span class="toc-number">2.</span> <span class="toc-text">WebSocket</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%86%E8%A7%A3WebSocket"><span class="toc-number">2.1.</span> <span class="toc-text">了解WebSocket</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#WebSocket%E5%B7%A5%E4%BD%9C%E8%BF%87%E7%A8%8B"><span class="toc-number">2.1.1.</span> <span class="toc-text">WebSocket工作过程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTTP%E9%95%BF%E8%BF%9E%E6%8E%A5%E4%B8%8EWebSocket%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-number">2.2.</span> <span class="toc-text">HTTP长连接与WebSocket的区别</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E9%95%BF%E8%BF%9E%E6%8E%A5"><span class="toc-number">2.2.1.</span> <span class="toc-text">HTTP长连接</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">2.2.1.1.</span> <span class="toc-text">适用场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E7%89%B9%E7%82%B9"><span class="toc-number">2.2.1.2.</span> <span class="toc-text">性能特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#WebSocket-1"><span class="toc-number">2.2.2.</span> <span class="toc-text">WebSocket</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF-1"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">适用场景</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%83%BD%E7%89%B9%E7%82%B9-1"><span class="toc-number">2.2.2.2.</span> <span class="toc-text">性能特点</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%BA%E5%88%AB%E6%80%BB%E7%BB%93"><span class="toc-number">2.2.3.</span> <span class="toc-text">区别总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Nginx"><span class="toc-number">3.</span> <span class="toc-text">Nginx</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Nginx%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E7%AE%97%E6%B3%95"><span class="toc-number">3.1.</span> <span class="toc-text">Nginx负载均衡算法</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/" title="数据库优化-分库分表"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/v2-b76d79b11c3e8dd25f3c6abae8889a88_720w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库优化-分库分表"/></a><div class="content"><a class="title" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/" title="数据库优化-分库分表">数据库优化-分库分表</a><time datetime="2024-11-03T08:20:54.000Z" title="发表于 2024-11-03 16:20:54">2024-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E4%B8%8E%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/" title="数据库优化-读写分离与冷热分离"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202411041125092.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库优化-读写分离与冷热分离"/></a><div class="content"><a class="title" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E4%B8%8E%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/" title="数据库优化-读写分离与冷热分离">数据库优化-读写分离与冷热分离</a><time datetime="2024-11-03T08:18:25.000Z" title="发表于 2024-11-03 16:18:25">2024-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/" title="操作系统-进程管理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410282316960.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统-进程管理"/></a><div class="content"><a class="title" href="/2024/10/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/" title="操作系统-进程管理">操作系统-进程管理</a><time datetime="2024-10-28T14:52:35.000Z" title="发表于 2024-10-28 22:52:35">2024-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/27/%E5%88%86%E5%B8%83%E5%BC%8F-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式-分布式事务"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410281041645.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分布式-分布式事务"/></a><div class="content"><a class="title" href="/2024/10/27/%E5%88%86%E5%B8%83%E5%BC%8F-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式-分布式事务">分布式-分布式事务</a><time datetime="2024-10-27T13:08:20.000Z" title="发表于 2024-10-27 21:08:20">2024-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/21/%E5%88%86%E5%B8%83%E5%BC%8F-%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86%EF%BC%88%E4%B8%8B%EF%BC%89/" title="分布式-服务治理（下）"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410272103963.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分布式-服务治理（下）"/></a><div class="content"><a class="title" href="/2024/10/21/%E5%88%86%E5%B8%83%E5%BC%8F-%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86%EF%BC%88%E4%B8%8B%EF%BC%89/" title="分布式-服务治理（下）">分布式-服务治理（下）</a><time datetime="2024-10-21T07:24:49.000Z" title="发表于 2024-10-21 15:24:49">2024-10-21</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 By <a class="footer-bar-link" href="/" title="xiaoyan" target="_blank">xiaoyan</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">45</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">66</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">18</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=12613265870&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AOP/" style="font-size: 0.88rem;">AOP<sup>1</sup></a><a href="/tags/Bean/" style="font-size: 0.88rem;">Bean<sup>1</sup></a><a href="/tags/DDD/" style="font-size: 0.88rem;">DDD<sup>1</sup></a><a href="/tags/IoC/" style="font-size: 0.88rem;">IoC<sup>1</sup></a><a href="/tags/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" style="font-size: 0.88rem;">Java8新特性<sup>1</sup></a><a href="/tags/Java%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" style="font-size: 0.88rem;">Java基本概念<sup>1</sup></a><a href="/tags/List/" style="font-size: 0.88rem;">List<sup>1</sup></a><a href="/tags/Map/" style="font-size: 0.88rem;">Map<sup>2</sup></a><a href="/tags/MyBatis/" style="font-size: 0.88rem;">MyBatis<sup>1</sup></a><a href="/tags/MySQL%E5%9F%BA%E7%A1%80/" style="font-size: 0.88rem;">MySQL基础<sup>1</sup></a><a href="/tags/Object/" style="font-size: 0.88rem;">Object<sup>1</sup></a><a href="/tags/SQL%E8%B0%83%E4%BC%98/" style="font-size: 0.88rem;">SQL调优<sup>1</sup></a><a href="/tags/Set/" style="font-size: 0.88rem;">Set<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 0.88rem;">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 0.88rem;">SpringCloud<sup>1</sup></a><a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 0.88rem;">事务<sup>2</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/" style="font-size: 0.88rem;">内存模型<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 0.88rem;">反射<sup>1</sup></a><a href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" style="font-size: 0.88rem;">垃圾回收<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 0.88rem;">多线程<sup>1</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">对象<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">并发安全<sup>1</sup></a><a href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 0.88rem;">序列化<sup>1</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8/" style="font-size: 0.88rem;">异常<sup>1</sup></a><a href="/tags/%E6%8B%B7%E8%B4%9D/" style="font-size: 0.88rem;">拷贝<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 0.88rem;">数据类型<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 0.88rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 0.88rem;">日志<sup>2</sup></a><a href="/tags/%E6%9F%A5%E8%AF%A2/" style="font-size: 0.88rem;">查询<sup>1</sup></a><a href="/tags/%E6%B3%9B%E5%9E%8B/" style="font-size: 0.88rem;">泛型<sup>1</sup></a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 0.88rem;">注解<sup>1</sup></a><a href="/tags/%E7%AD%96%E7%95%A5/" style="font-size: 0.88rem;">策略<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96/" style="font-size: 0.88rem;">类初始化<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" style="font-size: 0.88rem;">类加载<sup>1</sup></a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 0.88rem;">索引<sup>2</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/" style="font-size: 0.88rem;">线程模型<sup>1</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/" style="font-size: 0.88rem;">线程池<sup>1</sup></a><a href="/tags/%E9%94%81/" style="font-size: 0.88rem;">锁<sup>2</sup></a><a href="/tags/%E9%9B%86%E7%BE%A4/" style="font-size: 0.88rem;">集群<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>
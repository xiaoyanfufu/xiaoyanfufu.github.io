<!DOCTYPE html><html lang="zn-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>JVM-类初始化与类加载 | XIAOYAN</title><meta name="keywords" content="类加载,类初始化"><meta name="author" content="xiaoyan"><meta name="copyright" content="xiaoyan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="JVM-类初始化与类加载"><meta name="application-name" content="JVM-类初始化与类加载"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="JVM-类初始化与类加载"><meta property="og:url" content="http://example.com/2024/10/05/Java-JVM%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E7%B1%BB%E5%8A%A0%E8%BD%BD/index.html"><meta property="og:site_name" content="XIAOYAN"><meta property="og:description" content="对象创建的详细过程 在Java中，对象的创建是一个复杂且多步骤的过程，涉及类加载、内存分配、初始化等多个环节。以下是创建对象的详细步骤及其背后的原理：  类加载检查  当Java虚拟机（JVM）遇到一个new指令时，首先会在常量池中查找该对象的符号引用，并检查该类是否已经被加载、解析和初始化。如果该"><meta property="og:locale" content="zn-CN"><meta property="og:image" content="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410051712703.png"><meta property="article:author" content="xiaoyan"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410051712703.png"><meta name="description" content="对象创建的详细过程 在Java中，对象的创建是一个复杂且多步骤的过程，涉及类加载、内存分配、初始化等多个环节。以下是创建对象的详细步骤及其背后的原理：  类加载检查  当Java虚拟机（JVM）遇到一个new指令时，首先会在常量池中查找该对象的符号引用，并检查该类是否已经被加载、解析和初始化。如果该"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="canonical" href="http://example.com/2024/10/05/Java-JVM%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E7%B1%BB%E5%8A%A0%E8%BD%BD/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: undefined,
  diytitle: undefined,
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: xiaoyan","link":"链接: ","source":"来源: XIAOYAN","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'XIAOYAN',
  title: 'JVM-类初始化与类加载',
  postAI: '',
  pageFillDescription: '对象创建的详细过程, 对象的生命周期, 类加载器概述, 1. 启动类加载器（Bootstrap Class Loader）, 2. 扩展类加载器（Extension Class Loader）, 3. 系统类加载器x2F应用程序类加载器（System Class Loaderx2FApplication Class Loader）, 4. 自定义类加载器（Custom Class Loader）, 双亲委派模型, 双亲委派模型（Parent Delegation Model）, 双亲委派模型的作用, 1. 保证类的唯一性, 2. 保证安全性, 3. 支持隔离和层次划分, 4. 便于维护和扩展, 类加载过程对象创建的详细过程在中对象的创建是一个复杂且多步骤的过程涉及类加载内存分配初始化等多个环节以下是创建对象的详细步骤及其背后的原理类加载检查当虚拟机遇到一个指令时首先会在常量池中查找该对象的符号引用并检查该类是否已经被加载解析和初始化如果该类尚未被加载将触发类加载过程类加载过程包括加载验证准备解析和初始化五个阶段确保类在内存中正确地表示和初始化内存分配类加载完成后将为新生对象分配内存内存分配的大小在类加载阶段已经确定这通常是通过类的元数据信息如字段和方法的数量计算得出内存分配的方式取决于堆的内存模型可能采用指针碰撞或空闲列表等策略分配内存的过程实际上是从堆中划分出一块固定大小的内存空间初始化零值内存分配完成后需要对对象分配到的所有内存空间进行初始化零值操作这一步骤确保对象的字段在未显式赋值的情况下也能访问到默认的零值如为为等初始化零值操作不包括对象头对象头中存储的是对象的元数据信息对象头设置初始化零值完成后需要对对象进行必要的设置这些设置信息存储在对象头中对象头包含以下关键信息类元数据指针指向该对象所属类的元数据信息哈希码用于唯一标识对象的哈希码分代信息记录对象的分代年龄用于垃圾回收策略锁状态记录对象的锁状态用于同步机制这些信息对于对象的运行时行为和垃圾回收机制至关重要执行方法完成上述步骤后已经创建了一个基本结构的对象但尚未执行任何用户定义的初始化逻辑接下来会调用对象的方法即构造方法执行用户定义的初始化逻辑方法的执行包括调用父类的构造方法如果当前类是子类会先调用父类的构造方法初始化字段按照字段的声明顺序初始化字段的值执行构造方法体执行构造方法中的用户代码方法的执行确保对象的状态符合用户的预期从而完成对象的创建过程对象的生命周期对象的生命周期是指对象从创建到销毁的整个过程这一过程通常包括三个主要阶段创建使用和销毁理解对象的生命周期对于掌握编程语言的内存管理和资源分配机制至关重要创建阶段在创建阶段对象通过内存分配和初始化过程被引入到程序中具体步骤如下内存分配在中对象的创建通常通过关键字触发关键字会指示虚拟机在堆内存中为对象分配必要的内存空间实例化内存分配完成后会调用对象的构造函数构造函数负责执行对象的初始化操作包括设置对象的初始状态分配必要的资源等这一过程确保对象在创建后处于一个有效且可用的状态使用阶段在对象的使用阶段对象被程序中的其他部分引用并执行相应的操作具体包括引用与操作对象通过引用变量被程序的其他部分访问程序可以通过调用对象的方法和访问对象的属性来执行各种操作这些操作可能涉及对象状态的修改数据的处理与其他对象的交互等生命周期管理在对象的使用过程中程序需要确保对象的生命周期管理得当例如避免出现内存泄漏即对象不再被使用但仍占用内存空间合理的生命周期管理有助于提高程序的性能和稳定性销毁阶段当对象不再被引用时会通过垃圾回收机制自动回收对象所占用的内存空间销毁阶段的具体过程如下垃圾回收垃圾回收器是的一部分负责自动管理内存它会定期检测堆内存中不再被引用的对象并将其标记为可回收状态垃圾回收器使用多种算法如标记清除复制标记整理等来确定哪些对象可以被回收内存释放一旦对象被标记为可回收垃圾回收器会在适当的时候执行回收操作释放对象所占用的内存空间这一过程是自动进行的程序员无需显式调用销毁方法资源回收除了内存回收对象的销毁还可能涉及其他资源的释放如文件句柄数据库连接等在某些情况下程序员需要通过显式调用或等方法来确保资源的正确释放类加载器概述在虚拟机中类加载器是负责将类的字节码加载到内存中的组件类加载器按照层次结构组织形成了所谓的双亲委派模型以下是中常见的类加载器及其功能启动类加载器职责启动类加载器是中最顶层的类加载器负责加载的核心库如中的类这些类包括等实现启动类加载器通常由的一部分通过语言实现因此无法直接在程序中引用特点由于其特殊性启动类加载器没有父加载器它是所有其他类加载器的祖先扩展类加载器职责扩展类加载器负责加载扩展目录如中的包和类库这些扩展类库提供了额外的功能但不是核心库的一部分实现扩展类加载器是语言实现的继承自它的父加载器是启动类加载器特点扩展类加载器允许平台在不修改核心库的情况下扩展功能系统类加载器应用程序类加载器职责系统类加载器负责加载用户路径如环境变量指定的路径上的类库通常我们编写的应用程序默认使用的就是该类加载器实现系统类加载器同样是语言实现的继承自它的父加载器是扩展类加载器特点系统类加载器是大多数应用程序的默认类加载器负责加载应用程序的类和依赖库自定义类加载器职责开发者可以根据需求定制类加载器以实现特定的加载策略例如从网络数据库或其他非标准位置加载类实现自定义类加载器通常继承自并重写或方法特点自定义类加载器提供了灵活性允许开发者根据具体需求实现个性化的类加载逻辑双亲委派模型双亲委派模型双亲委派模型是类加载器体系的核心机制它定义了类加载器之间的层次关系和加载顺序其核心思想如下委派机制当一个类加载器收到类加载请求时它不会立即尝试加载类而是将请求委派给父类加载器每一层次的类加载器都会遵循这一原则直到请求到达顶层的启动类加载器加载顺序如果父类加载器无法加载该类即在父类加载器的搜索路径中找不到该类子类加载器才会尝试加载这种机制确保了类的加载顺序和层次结构避免了类的重复加载和潜在的冲突安全性双亲委派模型增强了平台的安全性因为它确保了核心库的类只能由启动类加载器加载防止了恶意代码替换核心类库的可能性双亲委派模型的作用保证类的唯一性通过委派机制双亲委派模型确保了所有类加载请求都会传给启动类加载器这一机制避免了不同类加载器重复加载相同类的情况确保了核心类库的统一性同时它也防止了用户自定义的类覆盖核心类库的可能性从而保证了类的唯一性保证安全性由于核心类库被启动类加载器加载而启动类加载器只加载信任的核心类库双亲委派模型可以防止恶意代码类冒充核心类增加系统的安全性这种机制确保了核心类库的完整性和安全性防止了潜在的安全漏洞支持隔离和层次划分双亲委派模型支持不同层次的类加载器服务于不同的类加载需求例如启动类加载器加载核心库类代码扩展类加载器加载框架的扩展代码应用程序类加载器加载用户的代码这种层次划分可以实现沙盒安全机制保证各个层级加载器的职责分明也便于维护和扩展每个层次的类加载器只负责加载特定范围内的类从而实现了类加载的隔离和层次划分便于维护和扩展双亲委派模型的层次结构使得类加载器的职责清晰便于维护和扩展开发者可以根据需求定制自定义类加载器并将其插入到现有的类加载器层次结构中这种灵活性使得平台能够适应不同的应用场景和需求增强了系统的可扩展性类加载过程类从被虚拟机加载到内存开始到卸载出内存为止它的整个生命周期包括以下七个阶段加载加载阶段是类加载过程的第一个阶段主要完成以下任务获取二进制字节流通过类的全限定名包名类名获取该类的文件的二进制字节流这个过程可以通过文件系统网络动态生成等方式实现转换为运行时数据结构将二进制字节流所代表的静态存储结构转化为方法区运行时的数据结构方法区是中的一块内存区域用于存储类的结构信息生成对象在内存中生成一个代表该类的对象作为方法区该类的各种数据的访问入口这个对象是反射机制的基础通过它可以获取类的所有信息连接连接阶段包括验证准备和解析三个子阶段统称为连接验证验证阶段的目的是确保文件中的字节流包含的信息符合当前虚拟机的要求保证这个被加载的类的正确性不会危害到虚拟机的安全验证阶段大致包括以下四个阶段的检验动作文件格式校验检查字节流是否符合文件格式的规范如魔数版本号常量池等元数据验证对类的元数据信息进行语义分析确保其符合语言规范如类是否有父类是否继承了不允许继承的类等字节码验证通过数据流和控制流分析确保方法体的字节码符合逻辑如操作数栈的数据类型与指令代码序列是否匹配跳转指令是否指向合理的位置等符号引用验证在解析阶段之前确保符号引用能够正确解析为直接引用如检查符号引用中的类字段方法是否存在且具有正确的访问权限准备准备阶段为类中的静态字段分配内存并设置初始值具体包括分配内存为类的静态字段分配内存空间设置初始值为静态字段设置默认初始值如类型初始值为类型初始值为被修饰的字段不会在此阶段设置因为在编译时就已经分配好了解析解析阶段是虚拟机将常量池中的符号引用替换为直接引用的过程具体包括符号引用符号引用是以一组符号来描述所引用的目标符号可以是任何形式的字面量只要使用时可以无歧义地定位到目标即可直接引用直接引用可以是直接指向目标的指针相对偏移量或者是一个可以间接定位到目标的句柄直接引用是和虚拟机实现的内存布局相关的如果有了直接引用那引用的目标必定是已存在于内存中的初始化初始化阶段是类加载的最后一个阶段主要任务是执行类的构造器方法方法具体包括执行方法方法是编译器自动生成的用于收集类中的静态字段赋值语句和静态代码块初始化阶段会按照代码顺序执行这些赋值语句和静态代码块线程安全方法在多线程环境中是线程安全的虚拟机会保证在多线程环境下只有一个线程执行方法其他线程会被阻塞使用使用阶段是指类或对象在程序中被实际使用的过程包括创建对象实例调用类的方法访问类的字段等卸载卸载阶段是指类从内存中被移除的过程类只有在以下情况下才会被卸载所有对象实例被回收该类的所有对象实例都已被垃圾回收器回收类加载器被回收加载该类的类加载器已被回收对象无引用类对应的对象没有在任何地方被引用无法在任何地方通过反射访问该类的方法',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-04 11:40:02',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/images/star.png"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">XIAOYAN</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=12613265870&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AOP/" style="font-size: 1.05rem;">AOP<sup>1</sup></a><a href="/tags/Bean/" style="font-size: 1.05rem;">Bean<sup>1</sup></a><a href="/tags/DDD/" style="font-size: 1.05rem;">DDD<sup>1</sup></a><a href="/tags/IoC/" style="font-size: 1.05rem;">IoC<sup>1</sup></a><a href="/tags/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" style="font-size: 1.05rem;">Java8新特性<sup>1</sup></a><a href="/tags/Java%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" style="font-size: 1.05rem;">Java基本概念<sup>1</sup></a><a href="/tags/List/" style="font-size: 1.05rem;">List<sup>1</sup></a><a href="/tags/Map/" style="font-size: 1.05rem;">Map<sup>2</sup></a><a href="/tags/MyBatis/" style="font-size: 1.05rem;">MyBatis<sup>1</sup></a><a href="/tags/MySQL%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">MySQL基础<sup>1</sup></a><a href="/tags/Object/" style="font-size: 1.05rem;">Object<sup>1</sup></a><a href="/tags/SQL%E8%B0%83%E4%BC%98/" style="font-size: 1.05rem;">SQL调优<sup>1</sup></a><a href="/tags/Set/" style="font-size: 1.05rem;">Set<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 1.05rem;">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 1.05rem;">SpringCloud<sup>1</sup></a><a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 1.05rem;">事务<sup>2</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/" style="font-size: 1.05rem;">内存模型<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 1.05rem;">反射<sup>1</sup></a><a href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" style="font-size: 1.05rem;">垃圾回收<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 1.05rem;">多线程<sup>1</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">对象<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">并发安全<sup>1</sup></a><a href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 1.05rem;">序列化<sup>1</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8/" style="font-size: 1.05rem;">异常<sup>1</sup></a><a href="/tags/%E6%8B%B7%E8%B4%9D/" style="font-size: 1.05rem;">拷贝<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 1.05rem;">数据类型<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.05rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 1.05rem;">日志<sup>2</sup></a><a href="/tags/%E6%9F%A5%E8%AF%A2/" style="font-size: 1.05rem;">查询<sup>1</sup></a><a href="/tags/%E6%B3%9B%E5%9E%8B/" style="font-size: 1.05rem;">泛型<sup>1</sup></a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 1.05rem;">注解<sup>1</sup></a><a href="/tags/%E7%AD%96%E7%95%A5/" style="font-size: 1.05rem;">策略<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96/" style="font-size: 1.05rem;">类初始化<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" style="font-size: 1.05rem;">类加载<sup>1</sup></a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 1.05rem;">索引<sup>2</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/" style="font-size: 1.05rem;">线程模型<sup>1</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/" style="font-size: 1.05rem;">线程池<sup>1</sup></a><a href="/tags/%E9%94%81/" style="font-size: 1.05rem;">锁<sup>2</sup></a><a href="/tags/%E9%9B%86%E7%BE%A4/" style="font-size: 1.05rem;">集群<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">November 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">October 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">25</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">July 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url">编程语言</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/" itemprop="url">Java</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/JVM/" itemprop="url">JVM</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>类加载</span></a><a class="article-meta__tags" href="/tags/%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>类初始化</span></a></span></div></div><h1 class="post-title" itemprop="name headline">JVM-类初始化与类加载</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-10-05T00:29:17.000Z" title="发表于 2024-10-05 08:29:17">2024-10-05</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-11-04T03:40:02.419Z" title="更新于 2024-11-04 11:40:02">2024-11-04</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为桂林"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>桂林</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410051712703.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/10/05/Java-JVM%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E7%B1%BB%E5%8A%A0%E8%BD%BD/"><header><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/" itemprop="url">编程语言</a><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/" itemprop="url">Java</a><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/JVM/" itemprop="url">JVM</a><a href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" tabindex="-1" itemprop="url">类加载</a><a href="/tags/%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96/" tabindex="-1" itemprop="url">类初始化</a><h1 id="CrawlerTitle" itemprop="name headline">JVM-类初始化与类加载</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">xiaoyan</span><time itemprop="dateCreated datePublished" datetime="2024-10-05T00:29:17.000Z" title="发表于 2024-10-05 08:29:17">2024-10-05</time><time itemprop="dateCreated datePublished" datetime="2024-11-04T03:40:02.419Z" title="更新于 2024-11-04 11:40:02">2024-11-04</time></header><h1 id="对象创建的详细过程"><a href="#对象创建的详细过程" class="headerlink" title="对象创建的详细过程"></a>对象创建的详细过程</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.xiaolincoding.com//picgo/1713516384566-e820b967-73ce-49a4-a6e6-36af9a38ebc4.webp"></p>
<p>在Java中，对象的创建是一个复杂且多步骤的过程，涉及类加载、内存分配、初始化等多个环节。以下是创建对象的详细步骤及其背后的原理：</p>
<ol>
<li><strong>类加载检查</strong></li>
</ol>
<p>当Java虚拟机（JVM）遇到一个<code>new</code>指令时，首先会在常量池中查找该对象的符号引用，并检查该类是否已经被加载、解析和初始化。如果该类尚未被加载，JVM将触发类加载过程。类加载过程包括加载、验证、准备、解析和初始化五个阶段，确保类在内存中正确地表示和初始化。</p>
<ol start="2">
<li><strong>内存分配</strong></li>
</ol>
<p>类加载完成后，JVM将为新生对象分配内存。内存分配的大小在类加载阶段已经确定，这通常是通过类的元数据信息（如字段和方法的数量）计算得出。内存分配的方式取决于Java堆的内存模型，可能采用指针碰撞（Bump-the-Pointer）或空闲列表（Free List）等策略。分配内存的过程实际上是从Java堆中划分出一块固定大小的内存空间。</p>
<ol start="3">
<li><strong>初始化零值</strong></li>
</ol>
<p>内存分配完成后，JVM需要对对象分配到的所有内存空间进行初始化零值操作。这一步骤确保对象的字段在未显式赋值的情况下，也能访问到默认的零值（如<code>int</code>为0，<code>boolean</code>为<code>false</code>等）。初始化零值操作不包括对象头（Object Header），对象头中存储的是对象的元数据信息。</p>
<ol start="4">
<li><strong>对象头设置</strong></li>
</ol>
<p>初始化零值完成后，JVM需要对对象进行必要的设置，这些设置信息存储在对象头中。对象头包含以下关键信息：</p>
<ul>
<li><strong>类元数据指针</strong>：指向该对象所属类的元数据信息。</li>
<li><strong>哈希码</strong>：用于唯一标识对象的哈希码。</li>
<li><strong>GC分代信息</strong>：记录对象的分代年龄，用于垃圾回收（GC）策略。</li>
<li><strong>锁状态</strong>：记录对象的锁状态，用于同步机制。</li>
</ul>
<p>这些信息对于对象的运行时行为和垃圾回收机制至关重要。</p>
<ol start="5">
<li><strong>执行<code>&lt;init&gt;</code>方法</strong></li>
</ol>
<p>完成上述步骤后，JVM已经创建了一个基本结构的对象，但尚未执行任何用户定义的初始化逻辑。接下来，JVM会调用对象的<code>&lt;init&gt;</code>方法（即构造方法），执行用户定义的初始化逻辑。<code>&lt;init&gt;</code>方法的执行包括：</p>
<ul>
<li><strong>调用父类的构造方法</strong>：如果当前类是子类，JVM会先调用父类的构造方法。</li>
<li><strong>初始化字段</strong>：按照字段的声明顺序，初始化字段的值。</li>
<li><strong>执行构造方法体</strong>：执行构造方法中的用户代码。</li>
</ul>
<p><code>&lt;init&gt;</code>方法的执行确保对象的状态符合用户的预期，从而完成对象的创建过程。</p>
<h1 id="对象的生命周期"><a href="#对象的生命周期" class="headerlink" title="对象的生命周期"></a>对象的生命周期</h1><p>对象的生命周期是指对象从创建到销毁的整个过程，这一过程通常包括三个主要阶段：创建、使用和销毁。理解对象的生命周期对于掌握编程语言的内存管理和资源分配机制至关重要。</p>
<p><strong>1. 创建阶段</strong></p>
<p>在创建阶段，对象通过内存分配和初始化过程被引入到程序中。具体步骤如下：</p>
<ul>
<li><p><strong>内存分配</strong>：在Java中，对象的创建通常通过<code>new</code>关键字触发。<code>new</code>关键字会指示Java虚拟机（JVM）在堆内存中为对象分配必要的内存空间。</p>
</li>
<li><p><strong>实例化</strong>：内存分配完成后，JVM会调用对象的构造函数（Constructor）。构造函数负责执行对象的初始化操作，包括设置对象的初始状态、分配必要的资源等。这一过程确保对象在创建后处于一个有效且可用的状态。</p>
</li>
</ul>
<p><strong>2. 使用阶段</strong></p>
<p>在对象的使用阶段，对象被程序中的其他部分引用，并执行相应的操作。具体包括：</p>
<ul>
<li><p><strong>引用与操作</strong>：对象通过引用变量被程序的其他部分访问。程序可以通过调用对象的方法（Methods）和访问对象的属性（Fields）来执行各种操作。这些操作可能涉及对象状态的修改、数据的处理、与其他对象的交互等。</p>
</li>
<li><p><strong>生命周期管理</strong>：在对象的使用过程中，程序需要确保对象的生命周期管理得当。例如，避免出现内存泄漏（Memory Leak），即对象不再被使用但仍占用内存空间。合理的生命周期管理有助于提高程序的性能和稳定性。</p>
</li>
</ul>
<p><strong>3. 销毁阶段</strong></p>
<p>当对象不再被引用时，JVM会通过垃圾回收机制（Garbage Collection, GC）自动回收对象所占用的内存空间。销毁阶段的具体过程如下：</p>
<ul>
<li><p><strong>垃圾回收</strong>：垃圾回收器是JVM的一部分，负责自动管理内存。它会定期检测堆内存中不再被引用的对象，并将其标记为可回收状态。垃圾回收器使用多种算法（如标记-清除、复制、标记-整理等）来确定哪些对象可以被回收。</p>
</li>
<li><p><strong>内存释放</strong>：一旦对象被标记为可回收，垃圾回收器会在适当的时候执行回收操作，释放对象所占用的内存空间。这一过程是自动进行的，程序员无需显式调用销毁方法。</p>
</li>
<li><p><strong>资源回收</strong>：除了内存回收，对象的销毁还可能涉及其他资源的释放，如文件句柄、数据库连接等。在某些情况下，程序员需要通过显式调用<code>close()</code>或<code>dispose()</code>等方法来确保资源的正确释放。</p>
</li>
</ul>
<h1 id="类加载器概述"><a href="#类加载器概述" class="headerlink" title="类加载器概述"></a>类加载器概述</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410051621096.png" alt="类加载器"></p>
<p>在Java虚拟机（JVM）中，类加载器（Class Loader）是负责将类的字节码加载到内存中的组件。类加载器按照层次结构组织，形成了所谓的“双亲委派模型”（Parent Delegation Model）。以下是Java中常见的类加载器及其功能：</p>
<h2 id="1-启动类加载器（Bootstrap-Class-Loader）"><a href="#1-启动类加载器（Bootstrap-Class-Loader）" class="headerlink" title="1. 启动类加载器（Bootstrap Class Loader）"></a>1. 启动类加载器（Bootstrap Class Loader）</h2><ul>
<li><p><strong>职责</strong>：启动类加载器是JVM中最顶层的类加载器，负责加载Java的核心库，如<code>rt.jar</code>中的类。这些类包括<code>java.lang.*</code>、<code>java.util.*</code>等。</p>
</li>
<li><p><strong>实现</strong>：启动类加载器通常由JVM的一部分通过C++语言实现，因此无法直接在Java程序中引用。</p>
</li>
<li><p><strong>特点</strong>：由于其特殊性，启动类加载器没有父加载器，它是所有其他类加载器的祖先。</p>
</li>
</ul>
<h2 id="2-扩展类加载器（Extension-Class-Loader）"><a href="#2-扩展类加载器（Extension-Class-Loader）" class="headerlink" title="2. 扩展类加载器（Extension Class Loader）"></a>2. 扩展类加载器（Extension Class Loader）</h2><ul>
<li><p><strong>职责</strong>：扩展类加载器负责加载Java扩展目录（如<code>$JAVA_HOME/lib/ext</code>）中的JAR包和类库。这些扩展类库提供了额外的功能，但不是Java核心库的一部分。</p>
</li>
<li><p><strong>实现</strong>：扩展类加载器是Java语言实现的，继承自<code>java.lang.ClassLoader</code>。它的父加载器是启动类加载器。</p>
</li>
<li><p><strong>特点</strong>：扩展类加载器允许Java平台在不修改核心库的情况下扩展功能。</p>
</li>
</ul>
<h2 id="3-系统类加载器-应用程序类加载器（System-Class-Loader-Application-Class-Loader）"><a href="#3-系统类加载器-应用程序类加载器（System-Class-Loader-Application-Class-Loader）" class="headerlink" title="3. 系统类加载器&#x2F;应用程序类加载器（System Class Loader&#x2F;Application Class Loader）"></a>3. 系统类加载器&#x2F;应用程序类加载器（System Class Loader&#x2F;Application Class Loader）</h2><ul>
<li><p><strong>职责</strong>：系统类加载器负责加载用户路径（如<code>CLASSPATH</code>环境变量指定的路径）上的类库。通常，我们编写的应用程序默认使用的就是该类加载器。</p>
</li>
<li><p><strong>实现</strong>：系统类加载器同样是Java语言实现的，继承自<code>java.lang.ClassLoader</code>。它的父加载器是扩展类加载器。</p>
</li>
<li><p><strong>特点</strong>：系统类加载器是大多数Java应用程序的默认类加载器，负责加载应用程序的类和依赖库。</p>
</li>
</ul>
<h2 id="4-自定义类加载器（Custom-Class-Loader）"><a href="#4-自定义类加载器（Custom-Class-Loader）" class="headerlink" title="4. 自定义类加载器（Custom Class Loader）"></a>4. 自定义类加载器（Custom Class Loader）</h2><ul>
<li><p><strong>职责</strong>：开发者可以根据需求定制类加载器，以实现特定的加载策略。例如，从网络、数据库或其他非标准位置加载类。</p>
</li>
<li><p><strong>实现</strong>：自定义类加载器通常继承自<code>java.lang.ClassLoader</code>，并重写<code>findClass()</code>或<code>loadClass()</code>方法。</p>
</li>
<li><p><strong>特点</strong>：自定义类加载器提供了灵活性，允许开发者根据具体需求实现个性化的类加载逻辑。</p>
</li>
</ul>
<h1 id="双亲委派模型"><a href="#双亲委派模型" class="headerlink" title="双亲委派模型"></a>双亲委派模型</h1><h2 id="双亲委派模型（Parent-Delegation-Model）"><a href="#双亲委派模型（Parent-Delegation-Model）" class="headerlink" title="双亲委派模型（Parent Delegation Model）"></a>双亲委派模型（Parent Delegation Model）</h2><p>双亲委派模型是Java类加载器体系的核心机制，它定义了类加载器之间的层次关系和加载顺序。其核心思想如下：</p>
<ul>
<li><p><strong>委派机制</strong>：当一个类加载器收到类加载请求时，它不会立即尝试加载类，而是将请求委派给父类加载器。每一层次的类加载器都会遵循这一原则，直到请求到达顶层的启动类加载器。</p>
</li>
<li><p><strong>加载顺序</strong>：如果父类加载器无法加载该类（即在父类加载器的搜索路径中找不到该类），子类加载器才会尝试加载。这种机制确保了类的加载顺序和层次结构，避免了类的重复加载和潜在的冲突。</p>
</li>
<li><p><strong>安全性</strong>：双亲委派模型增强了Java平台的安全性，因为它确保了核心库的类只能由启动类加载器加载，防止了恶意代码替换核心类库的可能性。</p>
</li>
</ul>
<h2 id="双亲委派模型的作用"><a href="#双亲委派模型的作用" class="headerlink" title="双亲委派模型的作用"></a>双亲委派模型的作用</h2><h3 id="1-保证类的唯一性"><a href="#1-保证类的唯一性" class="headerlink" title="1. 保证类的唯一性"></a>1. 保证类的唯一性</h3><p>通过委派机制，双亲委派模型确保了所有类加载请求都会传给启动类加载器。这一机制避免了不同类加载器重复加载相同类的情况，确保了Java核心类库的统一性。同时，它也防止了用户自定义的类覆盖Java核心类库的可能性，从而保证了类的唯一性。</p>
<h3 id="2-保证安全性"><a href="#2-保证安全性" class="headerlink" title="2. 保证安全性"></a>2. 保证安全性</h3><p>由于Java核心类库被启动类加载器加载，而启动类加载器只加载信任的核心类库，双亲委派模型可以防止恶意代码类冒充核心类，增加系统的安全性。这种机制确保了核心类库的完整性和安全性，防止了潜在的安全漏洞。</p>
<h3 id="3-支持隔离和层次划分"><a href="#3-支持隔离和层次划分" class="headerlink" title="3. 支持隔离和层次划分"></a>3. 支持隔离和层次划分</h3><p>双亲委派模型支持不同层次的类加载器服务于不同的类加载需求。例如：</p>
<ul>
<li><strong>启动类加载器</strong>：加载Java核心库类代码。</li>
<li><strong>扩展类加载器</strong>：加载框架的扩展代码。</li>
<li><strong>应用程序类加载器</strong>：加载用户的代码。</li>
</ul>
<p>这种层次划分可以实现沙盒安全机制，保证各个层级加载器的职责分明，也便于维护和扩展。每个层次的类加载器只负责加载特定范围内的类，从而实现了类加载的隔离和层次划分。</p>
<h3 id="4-便于维护和扩展"><a href="#4-便于维护和扩展" class="headerlink" title="4. 便于维护和扩展"></a>4. 便于维护和扩展</h3><p>双亲委派模型的层次结构使得类加载器的职责清晰，便于维护和扩展。开发者可以根据需求定制自定义类加载器，并将其插入到现有的类加载器层次结构中。这种灵活性使得Java平台能够适应不同的应用场景和需求，增强了系统的可扩展性。</p>
<h1 id="类加载过程"><a href="#类加载过程" class="headerlink" title="类加载过程"></a>类加载过程</h1><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410051712703.png" alt="类加载过程"></p>
<p>类从被虚拟机加载到内存开始，到卸载出内存为止，它的整个生命周期包括以下七个阶段：</p>
<ol>
<li><strong>加载（Loading）</strong></li>
</ol>
<p>加载阶段是类加载过程的第一个阶段，主要完成以下任务：</p>
<ul>
<li><p><strong>获取二进制字节流</strong>：通过类的全限定名（包名+类名），获取该类的<code>.class</code>文件的二进制字节流。这个过程可以通过文件系统、网络、动态生成等方式实现。</p>
</li>
<li><p><strong>转换为运行时数据结构</strong>：将二进制字节流所代表的静态存储结构，转化为方法区（Method Area）运行时的数据结构。方法区是JVM中的一块内存区域，用于存储类的结构信息。</p>
</li>
<li><p><strong>生成Class对象</strong>：在内存中生成一个代表该类的<code>java.lang.Class</code>对象，作为方法区该类的各种数据的访问入口。这个<code>Class</code>对象是反射机制的基础，通过它可以获取类的所有信息。</p>
</li>
</ul>
<ol start="2">
<li><strong>连接（Linking）</strong></li>
</ol>
<p>连接阶段包括验证、准备和解析三个子阶段，统称为连接。</p>
<p>​	2.1 验证（Verification）</p>
<p>验证阶段的目的是确保<code>.class</code>文件中的字节流包含的信息符合当前虚拟机的要求，保证这个被加载的类的正确性，不会危害到虚拟机的安全。验证阶段大致包括以下四个阶段的检验动作：</p>
<ul>
<li><p><strong>文件格式校验</strong>：检查字节流是否符合Class文件格式的规范，如魔数、版本号、常量池等。</p>
</li>
<li><p><strong>元数据验证</strong>：对类的元数据信息进行语义分析，确保其符合Java语言规范，如类是否有父类、是否继承了不允许继承的类等。</p>
</li>
<li><p><strong>字节码验证</strong>：通过数据流和控制流分析，确保方法体的字节码符合逻辑，如操作数栈的数据类型与指令代码序列是否匹配、跳转指令是否指向合理的位置等。</p>
</li>
<li><p><strong>符号引用验证</strong>：在解析阶段之前，确保符号引用能够正确解析为直接引用，如检查符号引用中的类、字段、方法是否存在且具有正确的访问权限。</p>
</li>
</ul>
<p>​	2.2 准备（Preparation）</p>
<p>准备阶段为类中的静态字段分配内存，并设置初始值。具体包括：</p>
<ul>
<li><p><strong>分配内存</strong>：为类的静态字段分配内存空间。</p>
</li>
<li><p><strong>设置初始值</strong>：为静态字段设置默认初始值，如<code>int</code>类型初始值为<code>0</code>，<code>boolean</code>类型初始值为<code>false</code>。被<code>final</code>修饰的<code>static</code>字段不会在此阶段设置，因为<code>final</code>在编译时就已经分配好了。</p>
</li>
</ul>
<p>​	2.3 解析（Resolution）</p>
<p>解析阶段是虚拟机将常量池中的“符号引用”替换为“直接引用”的过程。具体包括：</p>
<ul>
<li><p><strong>符号引用</strong>：符号引用是以一组符号来描述所引用的目标，符号可以是任何形式的字面量，只要使用时可以无歧义地定位到目标即可。</p>
</li>
<li><p><strong>直接引用</strong>：直接引用可以是直接指向目标的指针、相对偏移量或者是一个可以间接定位到目标的句柄。直接引用是和虚拟机实现的内存布局相关的。如果有了直接引用，那引用的目标必定是已存在于内存中的。</p>
</li>
</ul>
<ol start="3">
<li><strong>初始化（Initialization）</strong></li>
</ol>
<p>初始化阶段是类加载的最后一个阶段，主要任务是执行类的构造器方法（<code>&lt;clinit&gt;</code>方法）。具体包括：</p>
<ul>
<li><p><strong>执行<code>&lt;clinit&gt;</code>方法</strong>：<code>&lt;clinit&gt;</code>方法是编译器自动生成的，用于收集类中的静态字段赋值语句和静态代码块。初始化阶段会按照代码顺序执行这些赋值语句和静态代码块。</p>
</li>
<li><p><strong>线程安全</strong>：<code>&lt;clinit&gt;</code>方法在多线程环境中是线程安全的，虚拟机会保证在多线程环境下只有一个线程执行<code>&lt;clinit&gt;</code>方法，其他线程会被阻塞。</p>
</li>
</ul>
<ol start="4">
<li><strong>使用（Using）</strong></li>
</ol>
<p>使用阶段是指类或对象在程序中被实际使用的过程，包括创建对象实例、调用类的方法、访问类的字段等。</p>
<ol start="5">
<li><strong>卸载（Unloading）</strong></li>
</ol>
<p>卸载阶段是指类从内存中被移除的过程。类只有在以下情况下才会被卸载：</p>
<ol>
<li><p><strong>所有对象实例被回收</strong>：该类的所有对象实例都已被垃圾回收器回收。</p>
</li>
<li><p><strong>类加载器被回收</strong>：加载该类的类加载器已被回收。</p>
</li>
<li><p><strong>Class对象无引用</strong>：类对应的<code>java.lang.Class</code>对象没有在任何地方被引用，无法在任何地方通过反射访问该类的方法。</p>
</li>
</ol>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/user.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/user.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">xiaoyan</div><div class="post-copyright__author_desc">无限进步。</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/10/05/Java-JVM%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E7%B1%BB%E5%8A%A0%E8%BD%BD/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/10/05/Java-JVM%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E7%B1%BB%E5%8A%A0%E8%BD%BD/')">JVM-类初始化与类加载</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2024/10/05/Java-JVM%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E7%B1%BB%E5%8A%A0%E8%BD%BD/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=JVM-类初始化与类加载&amp;url=http://example.com/2024/10/05/Java-JVM%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96%E4%B8%8E%E7%B1%BB%E5%8A%A0%E8%BD%BD/&amp;pic=https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410051712703.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">XIAOYAN</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>编程语言<span class="categoryesPageCount">21</span></a><a class="post-meta__box__categoryes" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>Java<span class="categoryesPageCount">20</span></a><a class="post-meta__box__categoryes" href="/categories/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/Java/JVM/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>JVM<span class="categoryesPageCount">3</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>类加载<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>类初始化<span class="tagsPageCount">1</span></a></div></div><div class="post_share"><div class="social-share" data-image="https://pic1.zhimg.com/v2-b76d79b11c3e8dd25f3c6abae8889a88_720w.jpg?source=172ae18b" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/10/05/Java-JVM%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410050927260.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">JVM-内存模型</div></div></a></div><div class="next-post pull-right"><a href="/2024/10/05/Java-JVM%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.xiaolincoding.com//picgo/1718783586342-9da40db7-1dac-42ec-8148-81c10d8bfc04.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">JVM-垃圾回收</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/user.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">是一只时时翻垃圾吃的宅子。</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">xiaoyan</h1><div class="author-info__desc">无限进步。</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/xiaoyanfufu" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/483597064" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%88%9B%E5%BB%BA%E7%9A%84%E8%AF%A6%E7%BB%86%E8%BF%87%E7%A8%8B"><span class="toc-number">1.</span> <span class="toc-text">对象创建的详细过程</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E7%9A%84%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F"><span class="toc-number">2.</span> <span class="toc-text">对象的生命周期</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%E6%A6%82%E8%BF%B0"><span class="toc-number">3.</span> <span class="toc-text">类加载器概述</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E5%90%AF%E5%8A%A8%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%EF%BC%88Bootstrap-Class-Loader%EF%BC%89"><span class="toc-number">3.1.</span> <span class="toc-text">1. 启动类加载器（Bootstrap Class Loader）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%89%A9%E5%B1%95%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%EF%BC%88Extension-Class-Loader%EF%BC%89"><span class="toc-number">3.2.</span> <span class="toc-text">2. 扩展类加载器（Extension Class Loader）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E7%B3%BB%E7%BB%9F%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8-%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%EF%BC%88System-Class-Loader-Application-Class-Loader%EF%BC%89"><span class="toc-number">3.3.</span> <span class="toc-text">3. 系统类加载器&#x2F;应用程序类加载器（System Class Loader&#x2F;Application Class Loader）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E8%87%AA%E5%AE%9A%E4%B9%89%E7%B1%BB%E5%8A%A0%E8%BD%BD%E5%99%A8%EF%BC%88Custom-Class-Loader%EF%BC%89"><span class="toc-number">3.4.</span> <span class="toc-text">4. 自定义类加载器（Custom Class Loader）</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%A8%A1%E5%9E%8B"><span class="toc-number">4.</span> <span class="toc-text">双亲委派模型</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%A8%A1%E5%9E%8B%EF%BC%88Parent-Delegation-Model%EF%BC%89"><span class="toc-number">4.1.</span> <span class="toc-text">双亲委派模型（Parent Delegation Model）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%8C%E4%BA%B2%E5%A7%94%E6%B4%BE%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">4.2.</span> <span class="toc-text">双亲委派模型的作用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BF%9D%E8%AF%81%E7%B1%BB%E7%9A%84%E5%94%AF%E4%B8%80%E6%80%A7"><span class="toc-number">4.2.1.</span> <span class="toc-text">1. 保证类的唯一性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E4%BF%9D%E8%AF%81%E5%AE%89%E5%85%A8%E6%80%A7"><span class="toc-number">4.2.2.</span> <span class="toc-text">2. 保证安全性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%94%AF%E6%8C%81%E9%9A%94%E7%A6%BB%E5%92%8C%E5%B1%82%E6%AC%A1%E5%88%92%E5%88%86"><span class="toc-number">4.2.3.</span> <span class="toc-text">3. 支持隔离和层次划分</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BE%BF%E4%BA%8E%E7%BB%B4%E6%8A%A4%E5%92%8C%E6%89%A9%E5%B1%95"><span class="toc-number">4.2.4.</span> <span class="toc-text">4. 便于维护和扩展</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B1%BB%E5%8A%A0%E8%BD%BD%E8%BF%87%E7%A8%8B"><span class="toc-number">5.</span> <span class="toc-text">类加载过程</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/" title="数据库优化-分库分表"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/v2-b76d79b11c3e8dd25f3c6abae8889a88_720w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库优化-分库分表"/></a><div class="content"><a class="title" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/" title="数据库优化-分库分表">数据库优化-分库分表</a><time datetime="2024-11-03T08:20:54.000Z" title="发表于 2024-11-03 16:20:54">2024-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E4%B8%8E%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/" title="数据库优化-读写分离与冷热分离"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202411041125092.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库优化-读写分离与冷热分离"/></a><div class="content"><a class="title" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E4%B8%8E%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/" title="数据库优化-读写分离与冷热分离">数据库优化-读写分离与冷热分离</a><time datetime="2024-11-03T08:18:25.000Z" title="发表于 2024-11-03 16:18:25">2024-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/" title="操作系统-进程管理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410282316960.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统-进程管理"/></a><div class="content"><a class="title" href="/2024/10/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/" title="操作系统-进程管理">操作系统-进程管理</a><time datetime="2024-10-28T14:52:35.000Z" title="发表于 2024-10-28 22:52:35">2024-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/27/%E5%88%86%E5%B8%83%E5%BC%8F-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式-分布式事务"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410281041645.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分布式-分布式事务"/></a><div class="content"><a class="title" href="/2024/10/27/%E5%88%86%E5%B8%83%E5%BC%8F-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式-分布式事务">分布式-分布式事务</a><time datetime="2024-10-27T13:08:20.000Z" title="发表于 2024-10-27 21:08:20">2024-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/21/%E5%88%86%E5%B8%83%E5%BC%8F-%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86%EF%BC%88%E4%B8%8B%EF%BC%89/" title="分布式-服务治理（下）"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410272103963.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分布式-服务治理（下）"/></a><div class="content"><a class="title" href="/2024/10/21/%E5%88%86%E5%B8%83%E5%BC%8F-%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86%EF%BC%88%E4%B8%8B%EF%BC%89/" title="分布式-服务治理（下）">分布式-服务治理（下）</a><time datetime="2024-10-21T07:24:49.000Z" title="发表于 2024-10-21 15:24:49">2024-10-21</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 By <a class="footer-bar-link" href="/" title="xiaoyan" target="_blank">xiaoyan</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">45</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">66</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">18</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=12613265870&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AOP/" style="font-size: 0.88rem;">AOP<sup>1</sup></a><a href="/tags/Bean/" style="font-size: 0.88rem;">Bean<sup>1</sup></a><a href="/tags/DDD/" style="font-size: 0.88rem;">DDD<sup>1</sup></a><a href="/tags/IoC/" style="font-size: 0.88rem;">IoC<sup>1</sup></a><a href="/tags/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" style="font-size: 0.88rem;">Java8新特性<sup>1</sup></a><a href="/tags/Java%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" style="font-size: 0.88rem;">Java基本概念<sup>1</sup></a><a href="/tags/List/" style="font-size: 0.88rem;">List<sup>1</sup></a><a href="/tags/Map/" style="font-size: 0.88rem;">Map<sup>2</sup></a><a href="/tags/MyBatis/" style="font-size: 0.88rem;">MyBatis<sup>1</sup></a><a href="/tags/MySQL%E5%9F%BA%E7%A1%80/" style="font-size: 0.88rem;">MySQL基础<sup>1</sup></a><a href="/tags/Object/" style="font-size: 0.88rem;">Object<sup>1</sup></a><a href="/tags/SQL%E8%B0%83%E4%BC%98/" style="font-size: 0.88rem;">SQL调优<sup>1</sup></a><a href="/tags/Set/" style="font-size: 0.88rem;">Set<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 0.88rem;">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 0.88rem;">SpringCloud<sup>1</sup></a><a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 0.88rem;">事务<sup>2</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/" style="font-size: 0.88rem;">内存模型<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 0.88rem;">反射<sup>1</sup></a><a href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" style="font-size: 0.88rem;">垃圾回收<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 0.88rem;">多线程<sup>1</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">对象<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">并发安全<sup>1</sup></a><a href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 0.88rem;">序列化<sup>1</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8/" style="font-size: 0.88rem;">异常<sup>1</sup></a><a href="/tags/%E6%8B%B7%E8%B4%9D/" style="font-size: 0.88rem;">拷贝<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 0.88rem;">数据类型<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 0.88rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 0.88rem;">日志<sup>2</sup></a><a href="/tags/%E6%9F%A5%E8%AF%A2/" style="font-size: 0.88rem;">查询<sup>1</sup></a><a href="/tags/%E6%B3%9B%E5%9E%8B/" style="font-size: 0.88rem;">泛型<sup>1</sup></a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 0.88rem;">注解<sup>1</sup></a><a href="/tags/%E7%AD%96%E7%95%A5/" style="font-size: 0.88rem;">策略<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96/" style="font-size: 0.88rem;">类初始化<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" style="font-size: 0.88rem;">类加载<sup>1</sup></a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 0.88rem;">索引<sup>2</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/" style="font-size: 0.88rem;">线程模型<sup>1</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/" style="font-size: 0.88rem;">线程池<sup>1</sup></a><a href="/tags/%E9%94%81/" style="font-size: 0.88rem;">锁<sup>2</sup></a><a href="/tags/%E9%9B%86%E7%BE%A4/" style="font-size: 0.88rem;">集群<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>
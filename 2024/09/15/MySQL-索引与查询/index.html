<!DOCTYPE html><html lang="zn-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>MySQL-索引与查询 | XIAOYAN</title><meta name="keywords" content="索引,查询"><meta name="author" content="xiaoyan"><meta name="copyright" content="xiaoyan"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="MySQL-索引与查询"><meta name="application-name" content="MySQL-索引与查询"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="MySQL-索引与查询"><meta property="og:url" content="http://example.com/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/index.html"><meta property="og:site_name" content="XIAOYAN"><meta property="og:description" content="在数据库管理中，索引是提升查询性能的关键工具。本文将深入探讨MySQL中的索引类型，从数据结构、物理存储、字段特性和字段个数等多个维度进行详细分类和解析。   索引分类详解与深入探讨MySQL中索引的分类可以从多个维度进行划分，包括数据结构、物理存储、字段特性和字段个数等。以下是对这些分类的详细解释"><meta property="og:locale" content="zn-CN"><meta property="og:image" content="http://example.com/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/cover.png"><meta property="article:author" content="xiaoyan"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="http://example.com/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/cover.png"><meta name="description" content="在数据库管理中，索引是提升查询性能的关键工具。本文将深入探讨MySQL中的索引类型，从数据结构、物理存储、字段特性和字段个数等多个维度进行详细分类和解析。   索引分类详解与深入探讨MySQL中索引的分类可以从多个维度进行划分，包括数据结构、物理存储、字段特性和字段个数等。以下是对这些分类的详细解释"><link rel="shortcut icon" href="/images/favicon.ico"><link rel="canonical" href="http://example.com/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: undefined,
  diytitle: undefined,
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: xiaoyan","link":"链接: ","source":"来源: XIAOYAN","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'XIAOYAN',
  title: 'MySQL-索引与查询',
  postAI: '',
  pageFillDescription: '索引分类详解与深入探讨, 数据结构分类, B+Tree索引, Hash索引, Full-text索引, 物理存储分类, 聚簇索引（主键索引）, 二级索引（辅助索引）, 字段特性分类, 主键索引, 唯一索引, 普通索引, 前缀索引, 字段个数分类, 单列索引, 联合索引, 聚簇索引与非聚簇索引, 索引选择：自增ID vs UUID, 自增ID, 优点, 缺点, UUID, 优点, 缺点, 选择建议, 自增ID, UUID, 优化建议, 自增ID优化, UUID优化, 最左匹配原则, 详细解释, 无法利用索引的情况, 索引失效, 索引下推, 索引的结构, ICP 的工作原理, 示例, 没有 ICP 的情况：, 启用 ICP 的情况：, 总结, 索引下推和最左匹配原则, 区别, 联系, 回表与覆盖索引, 回表, 覆盖索引, 覆盖索引的优势, 实现覆盖索引的条件, 示例在数据库管理中索引是提升查询性能的关键工具本文将深入探讨中的索引类型从数据结构物理存储字段特性和字段个数等多个维度进行详细分类和解析索引分类详解与深入探讨中索引的分类可以从多个维度进行划分包括数据结构物理存储字段特性和字段个数等以下是对这些分类的详细解释和示例代码数据结构分类索引结构特点与应用场景索引是一种平衡多路搜索树所有数据存储在叶子节点非叶子节点仅存储索引键值这种结构保证了高效的查找插入和删除操作适用于范围查询排序操作和频繁的插入删除操作索引在大多数数据库系统中被广泛使用因其平衡性和高效性索引结构特点与应用场景索引通过哈希函数将索引键值映射到存储位置实现快速查找哈希索引的查找时间复杂度为适用于等值查询如用户登录验证唯一性检查等场景但由于不支持范围查询和排序应用场景较为有限索引结构特点与应用场景索引专门用于全文搜索支持对文本内容进行分词词干提取和倒排索引等操作实现高效的全文检索适用于需要进行文本分析和搜索的应用场景如搜索引擎文档管理系统等物理存储分类聚簇索引主键索引结构特点与应用场景聚簇索引将数据行与索引结构存储在一起主键索引即为聚簇索引聚簇索引决定了数据在磁盘上的物理存储顺序数据行的物理顺序与索引顺序一致适用于频繁访问的数据如用户表的主键索引聚簇索引能够提高数据访问的局部性减少磁盘操作二级索引辅助索引结构特点与应用场景二级索引存储索引键值和指向数据行的指针不直接存储数据行二级索引适用于非主键字段的查询可以加速查询操作如用户表中的邮箱字段索引二级索引可以提高查询效率但会增加额外的存储空间和维护成本字段特性分类主键索引结构特点与应用场景主键索引是唯一标识表中每一行的索引具有唯一性和非空性主键索引通常是聚簇索引适用于需要唯一标识每一行的场景如用户订单等主键索引能够确保数据的唯一性和完整性示例代码唯一索引结构特点与应用场景唯一索引确保索引字段的值唯一但不要求非空唯一索引适用于需要确保数据唯一性的场景如用户表中的邮箱字段唯一索引可以防止重复数据的插入示例代码普通索引结构特点与应用场景普通索引是最基本的索引类型不具有唯一性约束适用于加速查询操作普通索引可以提高查询效率但不会影响数据的唯一性如用户表中的姓名字段示例代码前缀索引结构特点与应用场景前缀索引是对字段的前缀部分创建的索引适用于长字段或文本字段的索引前缀索引可以减少索引存储空间和提高查询效率如用户表中的地址字段示例代码字段个数分类单列索引结构特点与应用场景单列索引是基于单个字段创建的索引适用于单字段查询场景单列索引可以提高单字段查询的效率如用户表中的姓名字段联合索引结构特点与应用场景联合索引是基于多个字段创建的索引适用于多字段查询场景联合索引可以提高多字段查询的效率但需要注意索引字段的顺序和查询条件的匹配遵循最左匹配原则如用户表中的姓名和年龄字段聚簇索引与非聚簇索引数据存储聚簇索引的数据行按照键值顺序存储索引的叶子节点包含了实际的数据行这意味着数据行的物理存储顺序与索引顺序一致数据行的位置由聚簇索引决定非聚簇索引的叶子节点存放的是索引键值和指向数据行的指针而不是完整的数据行这意味着非聚簇索引不直接影响数据行的物理存储顺序索引与数据关系通过聚簇索引查找数据时直接返回叶子节点中的完整数据行无需额外的查找操作通过非聚簇索引查找数据时首先查找到叶子节点获取存放的聚簇索引数据再通过聚簇索引查表获取完整数据行这个通过非聚簇索引获取聚簇索引数据并回溯查表的过程称为回表唯一性聚簇索引通常由主键构成因此一个表只能有一个聚簇索引聚簇索引决定了数据行的物理存储顺序具有唯一性一个表可以有多个非聚簇索引因为它们不直接影响数据行的物理存储顺序非聚簇索引可以基于多个字段创建具有较高的灵活性效率聚簇索引直接返回叶子节点中的完整数据行无需额外的查找操作因此在查找效率上通常优于非聚簇索引非聚簇索引可能需要进行回表操作即通过非聚簇索引获取聚簇索引数据再通过聚簇索引查表获取完整数据行回表操作会增加额外的开销因此在查找效率上通常低于聚簇索引索引选择自增在选择主键索引时自增和是两种常见的选项以下是对这两种选择的详细分析特别是从索引性能和存储效率的角度进行探讨自增优点顺序存储自增是顺序生成的因此数据行在磁盘上的存储顺序与索引顺序一致这使得树的叶子节点更加紧凑减少了内存碎片高效插入由于自增的顺序性新插入的数据行总是添加到树的末尾减少了树的调整操作提高了插入效率减少操作顺序存储的数据行更容易被缓存减少了磁盘操作提高了查询效率缺点可预测性自增的可预测性可能带来安全风险尤其是在分布式系统中容易暴露业务信息分布式系统中的问题在分布式系统中自增的生成和管理可能变得复杂需要额外的机制来保证全局唯一性优点全局唯一性由系统算法生成保证了全局唯一性适用于分布式系统中的数据唯一标识安全性的随机性使得其难以预测提高了数据的安全性缺点乱序存储的随机性导致数据行在磁盘上的存储顺序是乱序的使得树的叶子节点变得稀疏增加了内存碎片插入效率低由于的乱序性新插入的数据行可能需要频繁调整树的结构降低了插入效率增加操作稀疏的数据分布导致查询时可能需要多次提取数据页增加了磁盘操作降低了查询效率选择建议自增适用场景适用于单机或集中式数据库系统特别是需要高效插入和查询的场景示例用户表订单表等适用场景适用于分布式系统特别是需要全局唯一性和安全性的场景示例分布式系统中的用户标识订单标识等优化建议自增优化使用自增作为主键在单机或集中式数据库系统中使用自增作为主键可以提高插入和查询效率分布式系统中的自增在分布式系统中可以使用分布式生成器如算法来生成全局唯一的自增优化使用作为辅助索引在需要全局唯一性的场景中可以使用作为辅助索引而不是主键的顺序化处理在生成时可以考虑使用顺序如以减少树的稀疏性最左匹配原则最左匹配原则是联合索引的核心特性之一它规定了在查询中如何利用联合索引具体来说最左匹配原则要求查询条件必须从联合索引的最左边的字段开始匹配才能有效利用该索引详细解释联合索引在物理存储特性分类上归于聚簇索引或非聚簇索引具体取决于数据库的实现对于非聚簇索引存储的数据通常是对应记录的主键或其他唯一标识符因此可能需要执行回表操作来获取完整的数据假设我们有一个联合索引基于字段和创建在往联合索引表新增索引数据时首先会根据字段进行排序然后在的基础上根据字段进行排序依此类推总结来说字段是全局无序的仅相对于上一个索引字段局部有序完全匹配查询条件包含所有索引字段如这种情况下查询可以直接利用联合索引进行快速查找部分匹配查询条件包含部分索引字段但必须从最左边的字段开始如这种情况下查询可以利用索引的前两个字段进行查找单字段匹配查询条件只包含最左边的字段如这种情况下查询可以利用索引的第一个字段进行查找无法利用索引的情况以下几种查询条件无法利用联合索引跳过字段查询条件跳过了最左边的字段如这种情况下查询无法利用联合索引因为索引的构建顺序是从字段开始的范围查询在联合索引中范围查询如等可能会导致后续字段的索引失效例如如果查询条件是那么字段的索引可能无法被有效利用因为数据库引擎需要扫描所有满足的记录函数操作对索引字段进行函数操作如会导致索引失效因为数据库无法直接使用索引进行比较在实际应用中理解和遵循最左匹配原则对于优化查询性能至关重要通过合理设计和使用联合索引可以显著提高查询效率减少数据库的操作例如在设计联合索引时应优先选择区分度高的字段作为索引的前缀以确保索引的高效利用总之最左匹配原则是联合索引的核心理解并遵循这一原则可以帮助我们更好地设计和优化数据库索引从而提升系统的整体性能索引失效不满足最左匹配原则联合索引是按照索引字段的顺序进行排序的如果查询条件不从最左边的索引字段开始匹配数据库优化器无法利用索引的有序性导致索引失效使用函数或计算公式在查询条件中对索引字段使用函数或计算公式会导致索引失效因为数据库无法直接利用索引的有序性类型转换查询条件中的数据类型与索引字段的数据类型不匹配导致隐式类型转换索引可能失效隐式类型转换本质上也是一种函数操作使用条件在某些数据库中使用条件可能会导致索引失效因为数据库优化器可能无法同时利用多个索引范围查询范围查询如可能会导致索引失效尤其是当范围查询在联合索引的中间字段时索引下推索引下推的核心思想是在索引扫描阶段就应用部分查询条件从而减少从表中读取数据的次数为了在不读取数据的情况下知道条件是否符合利用了索引的结构和特性索引的结构索引通常是按照索引字段的顺序存储的并且每个索引条目通常包含索引字段的值和指向对应数据行的指针如主键或行标识符对于复合索引索引条目会按照索引字段的顺序进行排序的工作原理索引扫描数据库引擎首先使用索引查找满足索引条件的记录例如对于复合索引引擎会查找所有的记录应用部分查询条件在索引扫描阶段数据库引擎会应用部分查询条件非索引条件例如对于查询引擎会在索引扫描阶段就应用的条件过滤索引条目由于索引是按照索引字段的顺序存储的引擎可以在索引扫描阶段直接比较的值而不需要回表读取完整的数据行如果不满足条件引擎可以直接跳过该索引条目从而减少回表操作示例假设有一个表其中有一个复合索引并且执行以下查询没有的情况使用索引查找所有的记录根据这些记录的主键回表读取完整的数据行在读取完整数据行后应用的条件来过滤数据启用的情况在索引扫描阶段数据库引擎查找所有的记录在查找过程中引擎直接比较的值如果不满足的条件引擎可以直接跳过该索引条目只有满足且的记录才会被回表读取总结通过在索引扫描阶段就应用部分查询条件可以减少从表中读取数据的次数从而提高查询性能利用了索引的结构和特性在索引扫描阶段直接比较索引字段的值从而在不读取数据的情况下知道条件是否符合这种优化技术特别适用于复合索引和范围查询能够显著减少不必要的回表操作索引下推和最左匹配原则最左匹配原则只能按照从左到右一个个索引的匹配顺序进行索引查询若只实现了部分索引查询剩下的索引条件则全部失效最后会扫描并查找所有符合部分索引的查询而索引下推则在扫描索引阶段应用所有索引条件无需满足最左匹配原则若不满足索引条件则直接扫描下一条索引记录区别匹配顺序最左匹配原则要求查询条件从最左边的索引字段开始匹配确保索引能够被有效利用索引下推则允许在索引扫描阶段就应用部分查询条件无需满足最左匹配原则应用阶段最左匹配原则主要关注查询条件的匹配顺序确保查询条件从最左边的索引字段开始匹配索引下推则关注在索引扫描阶段就应用部分查询条件减少回表操作联系联合索引的利用最左匹配原则和都依赖于联合索引的结构最左匹配原则要求查询条件从最左边的索引字段开始匹配而则利用联合索引的有序性在索引扫描阶段应用部分查询条件提高查询性能最左匹配原则和都可以提高查询性能最左匹配原则通过确保查询条件从最左边的索引字段开始匹配使得数据库能够有效利用索引的有序性则通过在索引扫描阶段就应用部分查询条件减少回表操作从而提高查询性能回表与覆盖索引回表根据索引的物理存储特性索引可以分为聚簇索引和非聚簇索引聚簇索引在树中存放的是一条完整的记录行即索引和记录是放在一起的因此通过聚簇索引可以直接获取到完整的记录数据非聚簇索引存放的是索引值和对应记录的聚簇索引地址当通过非聚簇索引查找记录时只能拿到指向对应记录的索引地址然后需要根据这个地址再次查找聚簇索引最终返回数据表中的完整记录这个从非聚簇索引查找到聚簇索引后再次返回数据表进行查询的过程称为回表覆盖索引在使用非聚簇索引时如果查询所需的所有数据都包含在非聚簇索引的记录中那么就不需要进行回表操作直接返回结果这种情况称为覆盖索引覆盖索引的优势减少操作由于不需要回表减少了额外的磁盘操作提高了查询效率简化查询过程查询可以直接从索引中获取所需数据简化了查询过程实现覆盖索引的条件查询字段包含在索引中查询所需的所有字段都必须是索引的一部分避免回表确保查询结果可以直接从索引中获取而不需要额外的回表操作示例假设有一个表包含字段和并且有一个联合索引非覆盖索引查询由于查询需要所有字段而索引只包含和因此需要回表覆盖索引查询由于查询的字段都包含在索引中因此不需要回表直接从索引中返回结果',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-11-04 11:40:02',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="/images/star.png"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">XIAOYAN</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=12613265870&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AOP/" style="font-size: 1.05rem;">AOP<sup>1</sup></a><a href="/tags/Bean/" style="font-size: 1.05rem;">Bean<sup>1</sup></a><a href="/tags/DDD/" style="font-size: 1.05rem;">DDD<sup>1</sup></a><a href="/tags/IoC/" style="font-size: 1.05rem;">IoC<sup>1</sup></a><a href="/tags/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" style="font-size: 1.05rem;">Java8新特性<sup>1</sup></a><a href="/tags/Java%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" style="font-size: 1.05rem;">Java基本概念<sup>1</sup></a><a href="/tags/List/" style="font-size: 1.05rem;">List<sup>1</sup></a><a href="/tags/Map/" style="font-size: 1.05rem;">Map<sup>2</sup></a><a href="/tags/MyBatis/" style="font-size: 1.05rem;">MyBatis<sup>1</sup></a><a href="/tags/MySQL%E5%9F%BA%E7%A1%80/" style="font-size: 1.05rem;">MySQL基础<sup>1</sup></a><a href="/tags/Object/" style="font-size: 1.05rem;">Object<sup>1</sup></a><a href="/tags/SQL%E8%B0%83%E4%BC%98/" style="font-size: 1.05rem;">SQL调优<sup>1</sup></a><a href="/tags/Set/" style="font-size: 1.05rem;">Set<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 1.05rem;">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 1.05rem;">SpringCloud<sup>1</sup></a><a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 1.05rem;">事务<sup>2</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/" style="font-size: 1.05rem;">内存模型<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 1.05rem;">反射<sup>1</sup></a><a href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" style="font-size: 1.05rem;">垃圾回收<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 1.05rem;">多线程<sup>1</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">对象<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8/" style="font-size: 1.05rem;">并发安全<sup>1</sup></a><a href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 1.05rem;">序列化<sup>1</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8/" style="font-size: 1.05rem;">异常<sup>1</sup></a><a href="/tags/%E6%8B%B7%E8%B4%9D/" style="font-size: 1.05rem;">拷贝<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 1.05rem;">数据类型<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 1.05rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 1.05rem;">日志<sup>2</sup></a><a href="/tags/%E6%9F%A5%E8%AF%A2/" style="font-size: 1.05rem;">查询<sup>1</sup></a><a href="/tags/%E6%B3%9B%E5%9E%8B/" style="font-size: 1.05rem;">泛型<sup>1</sup></a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 1.05rem;">注解<sup>1</sup></a><a href="/tags/%E7%AD%96%E7%95%A5/" style="font-size: 1.05rem;">策略<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96/" style="font-size: 1.05rem;">类初始化<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" style="font-size: 1.05rem;">类加载<sup>1</sup></a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 1.05rem;">索引<sup>2</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/" style="font-size: 1.05rem;">线程模型<sup>1</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/" style="font-size: 1.05rem;">线程池<sup>1</sup></a><a href="/tags/%E9%94%81/" style="font-size: 1.05rem;">锁<sup>2</sup></a><a href="/tags/%E9%9B%86%E7%BE%A4/" style="font-size: 1.05rem;">集群<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 1.05rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">November 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">October 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">14</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">September 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">25</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">July 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93-%E7%BC%93%E5%AD%98/" itemprop="url">数据库&amp;缓存</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93-%E7%BC%93%E5%AD%98/MySQL/" itemprop="url">MySQL</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E7%B4%A2%E5%BC%95/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>索引</span></a><a class="article-meta__tags" href="/tags/%E6%9F%A5%E8%AF%A2/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>查询</span></a></span></div></div><h1 class="post-title" itemprop="name headline">MySQL-索引与查询</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-09-14T21:20:01.000Z" title="发表于 2024-09-15 05:20:01">2024-09-15</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-11-04T03:40:02.431Z" title="更新于 2024-11-04 11:40:02">2024-11-04</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为桂林"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>桂林</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/cover.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/"><header><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93-%E7%BC%93%E5%AD%98/" itemprop="url">数据库&amp;缓存</a><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93-%E7%BC%93%E5%AD%98/MySQL/" itemprop="url">MySQL</a><a href="/tags/%E7%B4%A2%E5%BC%95/" tabindex="-1" itemprop="url">索引</a><a href="/tags/%E6%9F%A5%E8%AF%A2/" tabindex="-1" itemprop="url">查询</a><h1 id="CrawlerTitle" itemprop="name headline">MySQL-索引与查询</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">xiaoyan</span><time itemprop="dateCreated datePublished" datetime="2024-09-14T21:20:01.000Z" title="发表于 2024-09-15 05:20:01">2024-09-15</time><time itemprop="dateCreated datePublished" datetime="2024-11-04T03:40:02.431Z" title="更新于 2024-11-04 11:40:02">2024-11-04</time></header><p>在数据库管理中，索引是提升查询性能的关键工具。本文将深入探讨MySQL中的索引类型，从数据结构、物理存储、字段特性和字段个数等多个维度进行详细分类和解析。</p>
<span id="more"></span>

<h1 id="索引分类详解与深入探讨"><a href="#索引分类详解与深入探讨" class="headerlink" title="索引分类详解与深入探讨"></a>索引分类详解与深入探讨</h1><p>MySQL中索引的分类可以从多个维度进行划分，包括数据结构、物理存储、字段特性和字段个数等。以下是对这些分类的详细解释和示例代码。</p>
<h2 id="数据结构分类"><a href="#数据结构分类" class="headerlink" title="数据结构分类"></a>数据结构分类</h2><h3 id="B-Tree索引"><a href="#B-Tree索引" class="headerlink" title="B+Tree索引"></a>B+Tree索引</h3><p><strong>结构特点与应用场景</strong>：B+Tree索引是一种平衡多路搜索树，所有数据存储在叶子节点，非叶子节点仅存储索引键值。这种结构保证了高效的查找、插入和删除操作，适用于范围查询、排序操作和频繁的插入、删除操作。B+Tree索引在大多数数据库系统中被广泛使用，因其平衡性和高效性。</p>
<h3 id="Hash索引"><a href="#Hash索引" class="headerlink" title="Hash索引"></a>Hash索引</h3><p><strong>结构特点与应用场景</strong>：Hash索引通过哈希函数将索引键值映射到存储位置，实现快速查找。哈希索引的查找时间复杂度为O(1)，适用于等值查询，如用户登录验证、唯一性检查等场景。但由于不支持范围查询和排序，应用场景较为有限。</p>
<h3 id="Full-text索引"><a href="#Full-text索引" class="headerlink" title="Full-text索引"></a>Full-text索引</h3><p><strong>结构特点与应用场景</strong>：Full-text索引专门用于全文搜索，支持对文本内容进行分词、词干提取和倒排索引等操作，实现高效的全文检索。适用于需要进行文本分析和搜索的应用场景，如搜索引擎、文档管理系统等。</p>
<h2 id="物理存储分类"><a href="#物理存储分类" class="headerlink" title="物理存储分类"></a>物理存储分类</h2><h3 id="聚簇索引（主键索引）"><a href="#聚簇索引（主键索引）" class="headerlink" title="聚簇索引（主键索引）"></a>聚簇索引（主键索引）</h3><p><strong>结构特点与应用场景</strong>：聚簇索引将数据行与索引结构存储在一起，主键索引即为聚簇索引。聚簇索引决定了数据在磁盘上的物理存储顺序，数据行的物理顺序与索引顺序一致，适用于频繁访问的数据，如用户表的主键索引。聚簇索引能够提高数据访问的局部性，减少磁盘I&#x2F;O操作。</p>
<h3 id="二级索引（辅助索引）"><a href="#二级索引（辅助索引）" class="headerlink" title="二级索引（辅助索引）"></a>二级索引（辅助索引）</h3><p><strong>结构特点与应用场景</strong>：二级索引存储索引键值和指向数据行的指针，不直接存储数据行。二级索引适用于非主键字段的查询，可以加速查询操作，如用户表中的邮箱字段索引。二级索引可以提高查询效率，但会增加额外的存储空间和维护成本。</p>
<h2 id="字段特性分类"><a href="#字段特性分类" class="headerlink" title="字段特性分类"></a>字段特性分类</h2><h3 id="主键索引"><a href="#主键索引" class="headerlink" title="主键索引"></a>主键索引</h3><p><strong>结构特点与应用场景</strong>：主键索引是唯一标识表中每一行的索引，具有唯一性和非空性。主键索引通常是聚簇索引，适用于需要唯一标识每一行的场景，如用户ID、订单ID等。主键索引能够确保数据的唯一性和完整性。</p>
<p>示例代码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="唯一索引"><a href="#唯一索引" class="headerlink" title="唯一索引"></a>唯一索引</h3><p><strong>结构特点与应用场景</strong>：唯一索引确保索引字段的值唯一，但不要求非空。唯一索引适用于需要确保数据唯一性的场景，如用户表中的邮箱字段。唯一索引可以防止重复数据的插入。</p>
<p>示例代码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    email <span class="type">VARCHAR</span>(<span class="number">100</span>) <span class="keyword">UNIQUE</span>,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="普通索引"><a href="#普通索引" class="headerlink" title="普通索引"></a>普通索引</h3><p><strong>结构特点与应用场景</strong>：普通索引是最基本的索引类型，不具有唯一性约束，适用于加速查询操作。普通索引可以提高查询效率，但不会影响数据的唯一性，如用户表中的姓名字段。</p>
<p>示例代码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    name <span class="type">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    INDEX idx_name (name)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h3 id="前缀索引"><a href="#前缀索引" class="headerlink" title="前缀索引"></a>前缀索引</h3><p><strong>结构特点与应用场景</strong>：前缀索引是对字段的前缀部分创建的索引，适用于长字段或文本字段的索引。前缀索引可以减少索引存储空间和提高查询效率，如用户表中的地址字段。</p>
<p>示例代码</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> users (</span><br><span class="line">    id <span class="type">INT</span> <span class="keyword">PRIMARY</span> KEY,</span><br><span class="line">    address <span class="type">VARCHAR</span>(<span class="number">200</span>),</span><br><span class="line">    INDEX idx_address (address(<span class="number">10</span>))</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<h2 id="字段个数分类"><a href="#字段个数分类" class="headerlink" title="字段个数分类"></a>字段个数分类</h2><h3 id="单列索引"><a href="#单列索引" class="headerlink" title="单列索引"></a>单列索引</h3><p><strong>结构特点与应用场景</strong>：单列索引是基于单个字段创建的索引，适用于单字段查询场景。单列索引可以提高单字段查询的效率，如用户表中的姓名字段。</p>
<h3 id="联合索引"><a href="#联合索引" class="headerlink" title="联合索引"></a>联合索引</h3><p><strong>结构特点与应用场景</strong>：联合索引是基于多个字段创建的索引，适用于多字段查询场景。联合索引可以提高多字段查询的效率，但需要注意索引字段的顺序和查询条件的匹配，遵循<strong>最左匹配原则</strong>，如用户表中的姓名和年龄字段。</p>
<h1 id="聚簇索引与非聚簇索引"><a href="#聚簇索引与非聚簇索引" class="headerlink" title="聚簇索引与非聚簇索引"></a>聚簇索引与非聚簇索引</h1><ul>
<li><p><strong>数据存储</strong></p>
<ul>
<li>聚簇索引的数据行按照键值顺序存储，索引的叶子节点包含了实际的数据行。这意味着数据行的物理存储顺序与索引顺序一致，数据行的位置由聚簇索引决定。</li>
<li>非聚簇索引的叶子节点存放的是索引键值和指向数据行的指针，而不是完整的数据行。这意味着非聚簇索引不直接影响数据行的物理存储顺序。</li>
</ul>
</li>
<li><p><strong>索引与数据关系</strong></p>
<ul>
<li>通过聚簇索引查找数据时，直接返回叶子节点中的完整数据行，无需额外的查找操作。</li>
<li>通过非聚簇索引查找数据时，首先查找到叶子节点，获取存放的聚簇索引数据，再通过聚簇索引查表获取完整数据行。这个通过非聚簇索引获取聚簇索引数据并回溯查表的过程称为<strong>回表</strong>。</li>
</ul>
</li>
<li><p><strong>唯一性</strong></p>
<ul>
<li>聚簇索引通常由主键构成，因此一个表只能有一个聚簇索引。聚簇索引决定了数据行的物理存储顺序，具有唯一性。</li>
<li>一个表可以有多个非聚簇索引，因为它们不直接影响数据行的物理存储顺序。非聚簇索引可以基于多个字段创建，具有较高的灵活性。</li>
</ul>
</li>
<li><p><strong>效率</strong></p>
<ul>
<li>聚簇索引直接返回叶子节点中的完整数据行，无需额外的查找操作，因此在查找效率上通常优于非聚簇索引。</li>
<li>非聚簇索引可能需要进行回表操作，即通过非聚簇索引获取聚簇索引数据，再通过聚簇索引查表获取完整数据行。回表操作会增加额外的I&#x2F;O开销，因此在查找效率上通常低于聚簇索引。</li>
</ul>
</li>
</ul>
<h1 id="索引选择：自增ID-vs-UUID"><a href="#索引选择：自增ID-vs-UUID" class="headerlink" title="索引选择：自增ID vs UUID"></a>索引选择：自增ID vs UUID</h1><p>在选择主键索引时，自增ID和UUID是两种常见的选项。以下是对这两种选择的详细分析，特别是从索引性能和存储效率的角度进行探讨。</p>
<h2 id="自增ID"><a href="#自增ID" class="headerlink" title="自增ID"></a>自增ID</h2><h3 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h3><ol>
<li><strong>顺序存储</strong>：自增ID是顺序生成的，因此数据行在磁盘上的存储顺序与索引顺序一致。这使得B+树的叶子节点更加紧凑，减少了内存碎片。</li>
<li><strong>高效插入</strong>：由于自增ID的顺序性，新插入的数据行总是添加到B+树的末尾，减少了B+树的调整操作，提高了插入效率。</li>
<li><strong>减少IO操作</strong>：顺序存储的数据行更容易被缓存，减少了磁盘I&#x2F;O操作，提高了查询效率。</li>
</ol>
<h3 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h3><ol>
<li><strong>可预测性</strong>：自增ID的可预测性可能带来安全风险，尤其是在分布式系统中，容易暴露业务信息。</li>
<li><strong>分布式系统中的问题</strong>：在分布式系统中，自增ID的生成和管理可能变得复杂，需要额外的机制来保证全局唯一性。</li>
</ol>
<h2 id="UUID"><a href="#UUID" class="headerlink" title="UUID"></a>UUID</h2><h3 id="优点-1"><a href="#优点-1" class="headerlink" title="优点"></a>优点</h3><ol>
<li><strong>全局唯一性</strong>：UUID由系统算法生成，保证了全局唯一性，适用于分布式系统中的数据唯一标识。</li>
<li><strong>安全性</strong>：UUID的随机性使得其难以预测，提高了数据的安全性。</li>
</ol>
<h3 id="缺点-1"><a href="#缺点-1" class="headerlink" title="缺点"></a>缺点</h3><ol>
<li><strong>乱序存储</strong>：UUID的随机性导致数据行在磁盘上的存储顺序是乱序的，使得B+树的叶子节点变得稀疏，增加了内存碎片。</li>
<li><strong>插入效率低</strong>：由于UUID的乱序性，新插入的数据行可能需要频繁调整B+树的结构，降低了插入效率。</li>
<li><strong>增加IO操作</strong>：稀疏的数据分布导致查询时可能需要多次提取数据页，增加了磁盘I&#x2F;O操作，降低了查询效率。</li>
</ol>
<h2 id="选择建议"><a href="#选择建议" class="headerlink" title="选择建议"></a>选择建议</h2><h3 id="自增ID-1"><a href="#自增ID-1" class="headerlink" title="自增ID"></a>自增ID</h3><ul>
<li><strong>适用场景</strong>：适用于单机或集中式数据库系统，特别是需要高效插入和查询的场景。</li>
<li><strong>示例</strong>：用户表、订单表等。</li>
</ul>
<h3 id="UUID-1"><a href="#UUID-1" class="headerlink" title="UUID"></a>UUID</h3><ul>
<li><strong>适用场景</strong>：适用于分布式系统，特别是需要全局唯一性和安全性的场景。</li>
<li><strong>示例</strong>：分布式系统中的用户标识、订单标识等。</li>
</ul>
<h2 id="优化建议"><a href="#优化建议" class="headerlink" title="优化建议"></a>优化建议</h2><h3 id="自增ID优化"><a href="#自增ID优化" class="headerlink" title="自增ID优化"></a>自增ID优化</h3><ul>
<li><strong>使用自增ID作为主键</strong>：在单机或集中式数据库系统中，使用自增ID作为主键，可以提高插入和查询效率。</li>
<li><strong>分布式系统中的自增ID</strong>：在分布式系统中，可以使用分布式ID生成器（如Snowflake算法）来生成全局唯一的自增ID。</li>
</ul>
<h3 id="UUID优化"><a href="#UUID优化" class="headerlink" title="UUID优化"></a>UUID优化</h3><ul>
<li><strong>使用UUID作为辅助索引</strong>：在需要全局唯一性的场景中，可以使用UUID作为辅助索引，而不是主键。</li>
<li><strong>UUID的顺序化处理</strong>：在生成UUID时，可以考虑使用顺序UUID（如UUID v1），以减少B+树的稀疏性。</li>
</ul>
<h1 id="最左匹配原则"><a href="#最左匹配原则" class="headerlink" title="最左匹配原则"></a>最左匹配原则</h1><p>最左匹配原则是联合索引的核心特性之一，它规定了在查询中如何利用联合索引。具体来说，最左匹配原则要求查询条件必须从联合索引的最左边的字段开始匹配，才能有效利用该索引。</p>
<h2 id="详细解释"><a href="#详细解释" class="headerlink" title="详细解释"></a>详细解释</h2><p>联合索引在物理存储特性分类上归于<strong>聚簇索引</strong>或<strong>非聚簇索引</strong>，具体取决于数据库的实现。对于非聚簇索引，存储的数据通常是对应记录的主键或其他唯一标识符，因此可能需要执行<strong>回表操作</strong>来获取完整的数据。</p>
<p>假设我们有一个联合索引，基于字段A、B和C创建。在往联合索引表新增索引数据时，首先会根据字段A进行排序，然后在A的基础上根据字段B进行排序，依此类推。总结来说，字段B、C是<strong>全局无序</strong>的，仅相对于上一个索引字段<strong>局部有序</strong>。</p>
<ol>
<li><p><strong>完全匹配</strong>：查询条件包含所有索引字段，如<code>WHERE A = &#39;value1&#39; AND B = &#39;value2&#39; AND C = &#39;value3&#39;</code>。这种情况下，查询可以直接利用联合索引进行快速查找。</p>
</li>
<li><p><strong>部分匹配</strong>：查询条件包含部分索引字段，但必须从最左边的字段开始，如<code>WHERE A = &#39;value1&#39; AND B = &#39;value2&#39;</code>。这种情况下，查询可以利用索引的前两个字段进行查找。</p>
</li>
<li><p><strong>单字段匹配</strong>：查询条件只包含最左边的字段，如<code>WHERE A = &#39;value1&#39;</code>。这种情况下，查询可以利用索引的第一个字段进行查找。</p>
</li>
</ol>
<h2 id="无法利用索引的情况"><a href="#无法利用索引的情况" class="headerlink" title="无法利用索引的情况"></a>无法利用索引的情况</h2><p>以下几种查询条件无法利用联合索引：</p>
<ol>
<li><p><strong>跳过字段</strong>：查询条件跳过了最左边的字段，如<code>WHERE B = &#39;value2&#39; AND C = &#39;value3&#39;</code>。这种情况下，查询无法利用联合索引，因为索引的构建顺序是从字段A开始的。</p>
</li>
<li><p><strong>范围查询</strong>：在联合索引中，范围查询（如<code>&gt;</code>、<code>&lt;</code>、<code>BETWEEN</code>等）可能会导致后续字段的索引失效。例如，如果查询条件是<code>WHERE A &gt; &#39;value1&#39; AND B = &#39;value2&#39;</code>，那么字段B的索引可能无法被有效利用，因为数据库引擎需要扫描所有满足 <code>A &gt; &#39;value1&#39;</code> 的记录。</p>
</li>
<li><p><strong>函数操作</strong>：对索引字段进行函数操作（如<code>LOWER(column)</code>）会导致索引失效，因为数据库无法直接使用索引进行比较。</p>
</li>
</ol>
<p>在实际应用中，理解和遵循最左匹配原则对于优化查询性能至关重要。通过合理设计和使用联合索引，可以显著提高查询效率，减少数据库的I&#x2F;O操作。例如，在设计联合索引时，应优先选择区分度高的字段作为索引的前缀，以确保索引的高效利用。</p>
<p>总之，最左匹配原则是联合索引的核心，理解并遵循这一原则可以帮助我们更好地设计和优化数据库索引，从而提升系统的整体性能。</p>
<h1 id="索引失效"><a href="#索引失效" class="headerlink" title="索引失效"></a>索引失效</h1><ul>
<li><p><strong>不满足最左匹配原则</strong>：联合索引（Composite Index）是按照索引字段的顺序进行排序的。如果查询条件不从最左边的索引字段开始匹配，数据库优化器无法利用索引的有序性，导致索引失效。</p>
</li>
<li><p><strong>使用函数或计算公式</strong>：在查询条件中对索引字段使用函数或计算公式会导致索引失效，因为数据库无法直接利用索引的有序性。</p>
</li>
<li><p><strong>类型转换</strong>：查询条件中的数据类型与索引字段的数据类型不匹配，导致隐式类型转换，索引可能失效。隐式类型转换本质上也是一种函数操作。</p>
</li>
<li><p><strong>使用 <code>OR</code> 条件</strong>：在某些数据库中，使用 <code>OR</code> 条件可能会导致索引失效，因为数据库优化器可能无法同时利用多个索引。</p>
</li>
<li><p><strong>范围查询</strong>：范围查询（如 <code>&gt;</code>、<code>&lt;</code>、<code>BETWEEN</code>）可能会导致索引失效，尤其是当范围查询在联合索引的中间字段时。</p>
</li>
</ul>
<h1 id="索引下推"><a href="#索引下推" class="headerlink" title="索引下推"></a>索引下推</h1><p><strong>索引下推（Index Condition Pushdown, ICP）</strong>的核心思想是在索引扫描阶段就应用部分查询条件，从而减少从表中读取数据的次数。为了在不读取数据的情况下知道条件是否符合，ICP 利用了索引的结构和特性。</p>
<h2 id="索引的结构"><a href="#索引的结构" class="headerlink" title="索引的结构"></a>索引的结构</h2><p>索引通常是按照索引字段的顺序存储的，并且每个索引条目通常包含索引字段的值和指向对应数据行的指针（如主键或行标识符）。对于复合索引，索引条目会按照索引字段的顺序进行排序。</p>
<h2 id="ICP-的工作原理"><a href="#ICP-的工作原理" class="headerlink" title="ICP 的工作原理"></a>ICP 的工作原理</h2><ol>
<li><p><strong>索引扫描</strong>：</p>
<p>数据库引擎首先使用索引查找满足索引条件的记录。例如，对于复合索引 <code>(customer_id, order_date)</code>，引擎会查找所有 <code>customer_id = 123</code> 的记录。</p>
</li>
<li><p><strong>应用部分查询条件</strong>：</p>
<p>在索引扫描阶段，数据库引擎会应用部分查询条件（非索引条件）。例如，对于查询 <code>WHERE customer_id = 123 AND order_date &gt; &#39;2023-01-01&#39;</code>，引擎会在索引扫描阶段就应用 <code>order_date &gt; &#39;2023-01-01&#39;</code> 的条件。</p>
</li>
<li><p><strong>过滤索引条目</strong>：</p>
<p>由于索引是按照索引字段的顺序存储的，引擎可以在索引扫描阶段直接比较 <code>order_date</code> 的值，而不需要回表读取完整的数据行。如果 <code>order_date</code> 不满足条件，引擎可以直接跳过该索引条目，从而减少回表操作。</p>
</li>
</ol>
<h3 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h3><p>假设有一个表 <code>orders</code>，其中有一个复合索引 <code>(customer_id, order_date)</code>，并且执行以下查询：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> orders</span><br><span class="line"><span class="keyword">WHERE</span> customer_id <span class="operator">=</span> <span class="number">123</span></span><br><span class="line">  <span class="keyword">AND</span> order_date <span class="operator">&gt;</span> <span class="string">&#x27;2023-01-01&#x27;</span>;</span><br></pre></td></tr></table></figure>

<h4 id="没有-ICP-的情况："><a href="#没有-ICP-的情况：" class="headerlink" title="没有 ICP 的情况："></a>没有 ICP 的情况：</h4><ol>
<li>使用索引查找所有 <code>customer_id = 123</code> 的记录。</li>
<li>根据这些记录的主键回表读取完整的数据行。</li>
<li>在读取完整数据行后，应用 <code>order_date &gt; &#39;2023-01-01&#39;</code> 的条件来过滤数据。</li>
</ol>
<h4 id="启用-ICP-的情况："><a href="#启用-ICP-的情况：" class="headerlink" title="启用 ICP 的情况："></a>启用 ICP 的情况：</h4><ol>
<li>在索引扫描阶段，数据库引擎查找所有 <code>customer_id = 123</code> 的记录。</li>
<li>在查找过程中，引擎直接比较 <code>order_date</code> 的值，如果 <code>order_date</code> 不满足 <code>order_date &gt; &#39;2023-01-01&#39;</code> 的条件，引擎可以直接跳过该索引条目。</li>
<li>只有满足 <code>customer_id = 123</code> 且 <code>order_date &gt; &#39;2023-01-01&#39;</code> 的记录才会被回表读取。</li>
</ol>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>通过在索引扫描阶段就应用部分查询条件，ICP 可以减少从表中读取数据的次数，从而提高查询性能。ICP 利用了索引的结构和特性，在索引扫描阶段直接比较索引字段的值，从而在不读取数据的情况下知道条件是否符合。这种优化技术特别适用于复合索引和范围查询，能够显著减少不必要的回表操作。</p>
<h2 id="索引下推和最左匹配原则"><a href="#索引下推和最左匹配原则" class="headerlink" title="索引下推和最左匹配原则"></a>索引下推和最左匹配原则</h2><p>最左匹配原则只能按照从左到右一个个索引的匹配顺序进行索引查询，若只实现了部分索引查询，剩下的索引条件则全部失效，最后会扫描并查找所有符合部分索引的查询；</p>
<p>而索引下推则在扫描索引阶段应用所有索引条件，无需满足最左匹配原则，若不满足索引条件则直接扫描下一条索引记录。</p>
<h4 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h4><ol>
<li><p><strong>匹配顺序</strong>：</p>
<p><strong>最左匹配原则</strong>要求查询条件从最左边的索引字段开始匹配，确保索引能够被有效利用。</p>
<p><strong>索引下推（ICP）</strong>则允许在索引扫描阶段就应用部分查询条件，无需满足最左匹配原则。</p>
</li>
<li><p><strong>应用阶段</strong>：</p>
<p><strong>最左匹配原则</strong>主要关注查询条件的匹配顺序，确保查询条件从最左边的索引字段开始匹配。</p>
<p><strong>索引下推（ICP）</strong>则关注在索引扫描阶段就应用部分查询条件，减少回表操作。</p>
</li>
</ol>
<h4 id="联系"><a href="#联系" class="headerlink" title="联系"></a>联系</h4><ol>
<li><strong>联合索引的利用</strong>：最左匹配原则和 ICP 都依赖于联合索引的结构。最左匹配原则要求查询条件从最左边的索引字段开始匹配，而 ICP 则利用联合索引的有序性在索引扫描阶段应用部分查询条件。</li>
<li><strong>提高查询性能</strong>：最左匹配原则和 ICP 都可以提高查询性能。最左匹配原则通过确保查询条件从最左边的索引字段开始匹配，使得数据库能够有效利用索引的有序性。ICP 则通过在索引扫描阶段就应用部分查询条件，减少回表操作，从而提高查询性能。</li>
</ol>
<h1 id="回表与覆盖索引"><a href="#回表与覆盖索引" class="headerlink" title="回表与覆盖索引"></a>回表与覆盖索引</h1><h2 id="回表"><a href="#回表" class="headerlink" title="回表"></a>回表</h2><p>根据索引的物理存储特性，索引可以分为<strong>聚簇索引</strong>和<strong>非聚簇索引</strong>。</p>
<ul>
<li><p><strong>聚簇索引</strong>：在B+树中存放的是一条完整的记录行，即索引和记录是放在一起的。因此，通过聚簇索引可以直接获取到完整的记录数据。</p>
</li>
<li><p><strong>非聚簇索引</strong>：存放的是索引值和对应记录的聚簇索引地址。当通过非聚簇索引查找记录时，只能拿到指向对应记录的索引地址，然后需要根据这个地址再次查找聚簇索引，最终返回数据表中的完整记录。这个从非聚簇索引查找到聚簇索引后再次返回数据表进行查询的过程称为<strong>回表</strong>。</p>
</li>
</ul>
<h2 id="覆盖索引"><a href="#覆盖索引" class="headerlink" title="覆盖索引"></a>覆盖索引</h2><p>在使用非聚簇索引时，如果查询所需的所有数据都包含在非聚簇索引的记录中，那么就不需要进行回表操作，直接返回结果。这种情况称为<strong>覆盖索引</strong>。</p>
<h3 id="覆盖索引的优势"><a href="#覆盖索引的优势" class="headerlink" title="覆盖索引的优势"></a>覆盖索引的优势</h3><ul>
<li><strong>减少I&#x2F;O操作</strong>：由于不需要回表，减少了额外的磁盘I&#x2F;O操作，提高了查询效率。</li>
<li><strong>简化查询过程</strong>：查询可以直接从索引中获取所需数据，简化了查询过程。</li>
</ul>
<h3 id="实现覆盖索引的条件"><a href="#实现覆盖索引的条件" class="headerlink" title="实现覆盖索引的条件"></a>实现覆盖索引的条件</h3><ul>
<li><strong>查询字段包含在索引中</strong>：查询所需的所有字段都必须是索引的一部分。</li>
<li><strong>避免回表</strong>：确保查询结果可以直接从索引中获取，而不需要额外的回表操作。</li>
</ul>
<h3 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h3><p>假设有一个表<code>orders</code>，包含字段<code>order_id</code>、<code>customer_id</code>和<code>order_date</code>，并且有一个联合索引<code>(order_id, customer_id)</code>。</p>
<ul>
<li><p><strong>非覆盖索引查询</strong>：<code>SELECT * FROM orders WHERE order_id = 123</code>。由于查询需要所有字段，而索引只包含<code>order_id</code>和<code>customer_id</code>，因此需要回表。</p>
</li>
<li><p><strong>覆盖索引查询</strong>：<code>SELECT order_id, customer_id FROM orders WHERE order_id = 123</code>。由于查询的字段都包含在索引中，因此不需要回表，直接从索引中返回结果。</p>
</li>
</ul>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/user.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/user.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">xiaoyan</div><div class="post-copyright__author_desc">无限进步。</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/')">MySQL-索引与查询</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=MySQL-索引与查询&amp;url=http://example.com/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/&amp;pic=/2024/09/15/MySQL-%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%9F%A5%E8%AF%A2/cover.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">XIAOYAN</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93-%E7%BC%93%E5%AD%98/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>数据库&amp;缓存<span class="categoryesPageCount">12</span></a><a class="post-meta__box__categoryes" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93-%E7%BC%93%E5%AD%98/MySQL/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>MySQL<span class="categoryesPageCount">5</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E7%B4%A2%E5%BC%95/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>索引<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/%E6%9F%A5%E8%AF%A2/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>查询<span class="tagsPageCount">1</span></a></div></div><div class="post_share"><div class="social-share" data-image="https://pic1.zhimg.com/v2-b76d79b11c3e8dd25f3c6abae8889a88_720w.jpg?source=172ae18b" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/15/MySQL-SQL%E5%9F%BA%E7%A1%80/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2024/09/15/MySQL-SQL%E5%9F%BA%E7%A1%80/cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MySQL-SQL基础</div></div></a></div><div class="next-post pull-right"><a href="/2024/09/15/MySQL-%E4%BA%8B%E5%8A%A1%E4%B8%8E%E6%97%A5%E5%BF%97/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2024/09/15/MySQL-%E4%BA%8B%E5%8A%A1%E4%B8%8E%E6%97%A5%E5%BF%97/cover.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MySQL-事务与日志</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2024/09/20/MySQL-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/" title="MySQL-性能调优"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/2024/09/20/MySQL-%E6%80%A7%E8%83%BD%E8%B0%83%E4%BC%98/cover.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-09-20</div><div class="title">MySQL-性能调优</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/images/user.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">是一只时时翻垃圾吃的宅子。</div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">xiaoyan</h1><div class="author-info__desc">无限进步。</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/xiaoyanfufu" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/483597064" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB%E8%AF%A6%E8%A7%A3%E4%B8%8E%E6%B7%B1%E5%85%A5%E6%8E%A2%E8%AE%A8"><span class="toc-number">1.</span> <span class="toc-text">索引分类详解与深入探讨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%88%86%E7%B1%BB"><span class="toc-number">1.1.</span> <span class="toc-text">数据结构分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#B-Tree%E7%B4%A2%E5%BC%95"><span class="toc-number">1.1.1.</span> <span class="toc-text">B+Tree索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Hash%E7%B4%A2%E5%BC%95"><span class="toc-number">1.1.2.</span> <span class="toc-text">Hash索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Full-text%E7%B4%A2%E5%BC%95"><span class="toc-number">1.1.3.</span> <span class="toc-text">Full-text索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%89%A9%E7%90%86%E5%AD%98%E5%82%A8%E5%88%86%E7%B1%BB"><span class="toc-number">1.2.</span> <span class="toc-text">物理存储分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%EF%BC%88%E4%B8%BB%E9%94%AE%E7%B4%A2%E5%BC%95%EF%BC%89"><span class="toc-number">1.2.1.</span> <span class="toc-text">聚簇索引（主键索引）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E7%BA%A7%E7%B4%A2%E5%BC%95%EF%BC%88%E8%BE%85%E5%8A%A9%E7%B4%A2%E5%BC%95%EF%BC%89"><span class="toc-number">1.2.2.</span> <span class="toc-text">二级索引（辅助索引）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E7%89%B9%E6%80%A7%E5%88%86%E7%B1%BB"><span class="toc-number">1.3.</span> <span class="toc-text">字段特性分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E9%94%AE%E7%B4%A2%E5%BC%95"><span class="toc-number">1.3.1.</span> <span class="toc-text">主键索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95"><span class="toc-number">1.3.2.</span> <span class="toc-text">唯一索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95"><span class="toc-number">1.3.3.</span> <span class="toc-text">普通索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%BC%80%E7%B4%A2%E5%BC%95"><span class="toc-number">1.3.4.</span> <span class="toc-text">前缀索引</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AD%97%E6%AE%B5%E4%B8%AA%E6%95%B0%E5%88%86%E7%B1%BB"><span class="toc-number">1.4.</span> <span class="toc-text">字段个数分类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%95%E5%88%97%E7%B4%A2%E5%BC%95"><span class="toc-number">1.4.1.</span> <span class="toc-text">单列索引</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%81%94%E5%90%88%E7%B4%A2%E5%BC%95"><span class="toc-number">1.4.2.</span> <span class="toc-text">联合索引</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95%E4%B8%8E%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95"><span class="toc-number">2.</span> <span class="toc-text">聚簇索引与非聚簇索引</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E9%80%89%E6%8B%A9%EF%BC%9A%E8%87%AA%E5%A2%9EID-vs-UUID"><span class="toc-number">3.</span> <span class="toc-text">索引选择：自增ID vs UUID</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%87%AA%E5%A2%9EID"><span class="toc-number">3.1.</span> <span class="toc-text">自增ID</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9"><span class="toc-number">3.1.1.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9"><span class="toc-number">3.1.2.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#UUID"><span class="toc-number">3.2.</span> <span class="toc-text">UUID</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BC%98%E7%82%B9-1"><span class="toc-number">3.2.1.</span> <span class="toc-text">优点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%BA%E7%82%B9-1"><span class="toc-number">3.2.2.</span> <span class="toc-text">缺点</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%BB%BA%E8%AE%AE"><span class="toc-number">3.3.</span> <span class="toc-text">选择建议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%A2%9EID-1"><span class="toc-number">3.3.1.</span> <span class="toc-text">自增ID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UUID-1"><span class="toc-number">3.3.2.</span> <span class="toc-text">UUID</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BC%98%E5%8C%96%E5%BB%BA%E8%AE%AE"><span class="toc-number">3.4.</span> <span class="toc-text">优化建议</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%A2%9EID%E4%BC%98%E5%8C%96"><span class="toc-number">3.4.1.</span> <span class="toc-text">自增ID优化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#UUID%E4%BC%98%E5%8C%96"><span class="toc-number">3.4.2.</span> <span class="toc-text">UUID优化</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9C%80%E5%B7%A6%E5%8C%B9%E9%85%8D%E5%8E%9F%E5%88%99"><span class="toc-number">4.</span> <span class="toc-text">最左匹配原则</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AF%A6%E7%BB%86%E8%A7%A3%E9%87%8A"><span class="toc-number">4.1.</span> <span class="toc-text">详细解释</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A0%E6%B3%95%E5%88%A9%E7%94%A8%E7%B4%A2%E5%BC%95%E7%9A%84%E6%83%85%E5%86%B5"><span class="toc-number">4.2.</span> <span class="toc-text">无法利用索引的情况</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E5%A4%B1%E6%95%88"><span class="toc-number">5.</span> <span class="toc-text">索引失效</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8"><span class="toc-number">6.</span> <span class="toc-text">索引下推</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E7%9A%84%E7%BB%93%E6%9E%84"><span class="toc-number">6.1.</span> <span class="toc-text">索引的结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ICP-%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86"><span class="toc-number">6.2.</span> <span class="toc-text">ICP 的工作原理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B"><span class="toc-number">6.2.1.</span> <span class="toc-text">示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B2%A1%E6%9C%89-ICP-%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%9A"><span class="toc-number">6.2.1.1.</span> <span class="toc-text">没有 ICP 的情况：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%AF%E7%94%A8-ICP-%E7%9A%84%E6%83%85%E5%86%B5%EF%BC%9A"><span class="toc-number">6.2.1.2.</span> <span class="toc-text">启用 ICP 的情况：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">6.2.2.</span> <span class="toc-text">总结</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B4%A2%E5%BC%95%E4%B8%8B%E6%8E%A8%E5%92%8C%E6%9C%80%E5%B7%A6%E5%8C%B9%E9%85%8D%E5%8E%9F%E5%88%99"><span class="toc-number">6.3.</span> <span class="toc-text">索引下推和最左匹配原则</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%BA%E5%88%AB"><span class="toc-number">6.3.0.1.</span> <span class="toc-text">区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%81%94%E7%B3%BB"><span class="toc-number">6.3.0.2.</span> <span class="toc-text">联系</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9E%E8%A1%A8%E4%B8%8E%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95"><span class="toc-number">7.</span> <span class="toc-text">回表与覆盖索引</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E8%A1%A8"><span class="toc-number">7.1.</span> <span class="toc-text">回表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95"><span class="toc-number">7.2.</span> <span class="toc-text">覆盖索引</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BC%98%E5%8A%BF"><span class="toc-number">7.2.1.</span> <span class="toc-text">覆盖索引的优势</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E8%A6%86%E7%9B%96%E7%B4%A2%E5%BC%95%E7%9A%84%E6%9D%A1%E4%BB%B6"><span class="toc-number">7.2.2.</span> <span class="toc-text">实现覆盖索引的条件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-1"><span class="toc-number">7.2.3.</span> <span class="toc-text">示例</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/" title="数据库优化-分库分表"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://pic1.zhimg.com/v2-b76d79b11c3e8dd25f3c6abae8889a88_720w.jpg?source=172ae18b" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库优化-分库分表"/></a><div class="content"><a class="title" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8/" title="数据库优化-分库分表">数据库优化-分库分表</a><time datetime="2024-11-03T08:20:54.000Z" title="发表于 2024-11-03 16:20:54">2024-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E4%B8%8E%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/" title="数据库优化-读写分离与冷热分离"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202411041125092.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据库优化-读写分离与冷热分离"/></a><div class="content"><a class="title" href="/2024/11/03/%E6%95%B0%E6%8D%AE%E5%BA%93%E4%BC%98%E5%8C%96-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E4%B8%8E%E5%86%B7%E7%83%AD%E5%88%86%E7%A6%BB/" title="数据库优化-读写分离与冷热分离">数据库优化-读写分离与冷热分离</a><time datetime="2024-11-03T08:18:25.000Z" title="发表于 2024-11-03 16:18:25">2024-11-03</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/" title="操作系统-进程管理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410282316960.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="操作系统-进程管理"/></a><div class="content"><a class="title" href="/2024/10/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/" title="操作系统-进程管理">操作系统-进程管理</a><time datetime="2024-10-28T14:52:35.000Z" title="发表于 2024-10-28 22:52:35">2024-10-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/27/%E5%88%86%E5%B8%83%E5%BC%8F-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式-分布式事务"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410281041645.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分布式-分布式事务"/></a><div class="content"><a class="title" href="/2024/10/27/%E5%88%86%E5%B8%83%E5%BC%8F-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1/" title="分布式-分布式事务">分布式-分布式事务</a><time datetime="2024-10-27T13:08:20.000Z" title="发表于 2024-10-27 21:08:20">2024-10-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/10/21/%E5%88%86%E5%B8%83%E5%BC%8F-%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86%EF%BC%88%E4%B8%8B%EF%BC%89/" title="分布式-服务治理（下）"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://xiaoyanfufu-io.oss-cn-guangzhou.aliyuncs.com/blog/202410272103963.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="分布式-服务治理（下）"/></a><div class="content"><a class="title" href="/2024/10/21/%E5%88%86%E5%B8%83%E5%BC%8F-%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86%EF%BC%88%E4%B8%8B%EF%BC%89/" title="分布式-服务治理（下）">分布式-服务治理（下）</a><time datetime="2024-10-21T07:24:49.000Z" title="发表于 2024-10-21 15:24:49">2024-10-21</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2024 By <a class="footer-bar-link" href="/" title="xiaoyan" target="_blank">xiaoyan</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">45</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">66</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">18</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/?id=12613265870&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size: 0.9em;"></i><span> 关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size: 0.9em;"></i><span> 随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AOP/" style="font-size: 0.88rem;">AOP<sup>1</sup></a><a href="/tags/Bean/" style="font-size: 0.88rem;">Bean<sup>1</sup></a><a href="/tags/DDD/" style="font-size: 0.88rem;">DDD<sup>1</sup></a><a href="/tags/IoC/" style="font-size: 0.88rem;">IoC<sup>1</sup></a><a href="/tags/Java8%E6%96%B0%E7%89%B9%E6%80%A7/" style="font-size: 0.88rem;">Java8新特性<sup>1</sup></a><a href="/tags/Java%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5/" style="font-size: 0.88rem;">Java基本概念<sup>1</sup></a><a href="/tags/List/" style="font-size: 0.88rem;">List<sup>1</sup></a><a href="/tags/Map/" style="font-size: 0.88rem;">Map<sup>2</sup></a><a href="/tags/MyBatis/" style="font-size: 0.88rem;">MyBatis<sup>1</sup></a><a href="/tags/MySQL%E5%9F%BA%E7%A1%80/" style="font-size: 0.88rem;">MySQL基础<sup>1</sup></a><a href="/tags/Object/" style="font-size: 0.88rem;">Object<sup>1</sup></a><a href="/tags/SQL%E8%B0%83%E4%BC%98/" style="font-size: 0.88rem;">SQL调优<sup>1</sup></a><a href="/tags/Set/" style="font-size: 0.88rem;">Set<sup>1</sup></a><a href="/tags/SpringBoot/" style="font-size: 0.88rem;">SpringBoot<sup>1</sup></a><a href="/tags/SpringCloud/" style="font-size: 0.88rem;">SpringCloud<sup>1</sup></a><a href="/tags/%E4%BA%8B%E5%8A%A1/" style="font-size: 0.88rem;">事务<sup>2</sup></a><a href="/tags/%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B/" style="font-size: 0.88rem;">内存模型<sup>1</sup></a><a href="/tags/%E5%8F%8D%E5%B0%84/" style="font-size: 0.88rem;">反射<sup>1</sup></a><a href="/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/" style="font-size: 0.88rem;">垃圾回收<sup>1</sup></a><a href="/tags/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" style="font-size: 0.88rem;">多线程<sup>1</sup></a><a href="/tags/%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">对象<sup>1</sup></a><a href="/tags/%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8/" style="font-size: 0.88rem;">并发安全<sup>1</sup></a><a href="/tags/%E5%BA%8F%E5%88%97%E5%8C%96/" style="font-size: 0.88rem;">序列化<sup>1</sup></a><a href="/tags/%E5%BC%82%E5%B8%B8/" style="font-size: 0.88rem;">异常<sup>1</sup></a><a href="/tags/%E6%8B%B7%E8%B4%9D/" style="font-size: 0.88rem;">拷贝<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" style="font-size: 0.88rem;">数据类型<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" style="font-size: 0.88rem;">数据结构<sup>1</sup></a><a href="/tags/%E6%97%A5%E5%BF%97/" style="font-size: 0.88rem;">日志<sup>2</sup></a><a href="/tags/%E6%9F%A5%E8%AF%A2/" style="font-size: 0.88rem;">查询<sup>1</sup></a><a href="/tags/%E6%B3%9B%E5%9E%8B/" style="font-size: 0.88rem;">泛型<sup>1</sup></a><a href="/tags/%E6%B3%A8%E8%A7%A3/" style="font-size: 0.88rem;">注解<sup>1</sup></a><a href="/tags/%E7%AD%96%E7%95%A5/" style="font-size: 0.88rem;">策略<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%88%9D%E5%A7%8B%E5%8C%96/" style="font-size: 0.88rem;">类初始化<sup>1</sup></a><a href="/tags/%E7%B1%BB%E5%8A%A0%E8%BD%BD/" style="font-size: 0.88rem;">类加载<sup>1</sup></a><a href="/tags/%E7%B4%A2%E5%BC%95/" style="font-size: 0.88rem;">索引<sup>2</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%A8%A1%E5%9E%8B/" style="font-size: 0.88rem;">线程模型<sup>1</sup></a><a href="/tags/%E7%BA%BF%E7%A8%8B%E6%B1%A0/" style="font-size: 0.88rem;">线程池<sup>1</sup></a><a href="/tags/%E9%94%81/" style="font-size: 0.88rem;">锁<sup>2</sup></a><a href="/tags/%E9%9B%86%E7%BE%A4/" style="font-size: 0.88rem;">集群<sup>1</sup></a><a href="/tags/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" style="font-size: 0.88rem;">面向对象<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>